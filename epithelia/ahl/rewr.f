	PROGRAM REWR
C  PROGRAM TO READ A FILE TO BE SPECIFIED AT RUNTIME
C
C
	INTEGER NWR,IWR(40),JWR(40)
	REAL RES(85,9)
C
	CHARACTER*5 VNAME1,VNAME2,SW,SWI
	CHARACTER*15 IPTFIL,OPTFIL,VARNAM
C
	PRINT 2
    2   FORMAT(' PRINT THE INPUT FILENAME:',$)
	READ 4, IPTFIL
	PRINT 6
    6   FORMAT(' PRINT THE OUTPUT FILENAME:',$)
	READ 4, OPTFIL
    4   FORMAT (A15)
C
	OPEN(1,FILE=IPTFIL)
	OPEN(2,FILE=OPTFIL)
C
C
	PRINT 100
  100   FORMAT(' IS INPUT FROM A DATA FILE OR INTERACTIVE? (d/i): ',$)
	READ 30, SWI
  110   IF (SWI.EQ.'i') GO TO 15
	PRINT 116
  116   FORMAT(' TYPE THE VARIABLE FILENAME:',$)
	READ 114, VARNAM
  114   FORMAT(A15)
	OPEN(3,FILE=VARNAM)
	READ (3,115) NWR
  115   FORMAT(3X,I2)
	DO 125 KWR=1,NWR
	READ (3,130) VNAME1,VNAME2
	CALL SELEC(VNAME1,VNAME2,IWR(KWR),JWR(KWR),*125,*135)
  125   CONTINUE
  130   FORMAT(2A5)
	GO TO 801
  135   PRINT 136
  136   FORMAT ('ERROR IN VARIABLE SELECTION')
	STOP
C
   15   PRINT 10
   10   FORMAT(' PRINT THE NUMBER OF VARIABLES TO BE REWRITTEN')
	READ *, NWR
	DO 800 KWR=1,NWR
C
   18   PRINT 20, KWR
   20   FORMAT(' PRINT THE NAME OF VARIABLE NUMBER-',I2)
	READ 30, VNAME1
   30   FORMAT(A5)
C
  200   PRINT 201
  201   FORMAT(' PRINT THE SPECIES')
	READ 30, VNAME2
C
	CALL SELEC(VNAME1,VNAME2,IWR(KWR),JWR(KWR),*800,*18)
C
  800   CONTINUE
  801   CONTINUE
C
C
	PRINT 290
  290   FORMAT(' IS THIS A TRANSIENT (TR) OR STEADY STATE (SS) EXPT.')
	READ 292, SW
  292   FORMAT(A2)
C
C
  300   READ(1,310,END=900) (RES(1,J),J=1,5)
  310   FORMAT (64(/),10X,F9.4,////,6X,4D12.4)
	READ(1,315) (RES(2,J),J=1,4)
  315   FORMAT(///,8X,4F12.3)
	READ(1,320) (RES(3,J),J=1,4)
  320   FORMAT(///,8X,4F12.3)
	READ(1,325) ((RES(I,J),J=1,4),I=4,7)
  325   FORMAT(///,(9X,4F12.6))
	READ(1,330) (RES(8,J),J=1,4)
  330   FORMAT(10X,4D12.4)
	READ(1,335) ((RES(I,J),J=1,4),I=9,12)
  335   FORMAT(9X,4F12.6)
	READ(1,330) (RES(13,J),J=1,4)
	READ(1,335) (RES(14,J),J=1,4)
	READ(1,330) (RES(15,J),J=1,4)
	READ(1,340) RES(16,1),(RES(16,J),J=3,4)
  340   FORMAT(9X,F12.6,12X,2F12.6)
	READ(1,335) ((RES(I,J),J=1,4),I=17,18)
	READ(1,345) ((RES(I,J),J=3,3),I=19,20)
  345   FORMAT(33X,1F12.6)
	READ(1,350) ((RES(I,J),J=1,3),I=21,32)
  350   FORMAT(///,(9X,3F12.4))
	READ(1,355) (RES(33,J),J=1,3)
  355   FORMAT(///,9X,3D12.4)
	READ(1,360) ((RES(I,J),J=1,3),I=34,45)
  360   FORMAT(///,(9X,3D12.4))
	READ(1,365) RES(41,1)
  365   FORMAT(9X,D12.4)
	READ(1,370) RES(47,1),RES(47,2),(RES(47,J),J=4,5)
  370   FORMAT(///,9X,2D12.4,12X,2D12.4)
	READ(1,375) (RES(I,1),RES(I,2),(RES(I,J),J=4,5),I=48,59)
  375   FORMAT(///,(9X,2D12.4,12X,2D12.4))
	READ(1,380) RES(60,1)
  380   FORMAT(9X,D12.4)
	READ(1,385) ((RES(I,J),J=1,3),I=61,72)
  385   FORMAT(///,(9X,3D12.4))
	READ(1,390) ((RES(I,J),J=1,3),I=73,84)
  390   FORMAT(///,(9X,3D12.4))
C
C
	WRITE(2,400) (RES(IWR(KWR),JWR(KWR)),KWR=1,NWR)
  400   FORMAT(8E16.8)
C
	IF(SW.EQ.'ss') GO TO 300
C
  500   READ(1,510,END=900) (RES(1,J),J=1,5)
  510   FORMAT (/,10X,F9.4,////,6X,4D12.4)
	READ(1,515) (RES(2,J),J=1,4)
  515   FORMAT(///,8X,4F12.3)
	READ(1,520) (RES(3,J),J=1,4)
  520   FORMAT(///,8X,4F12.3)
	READ(1,525) ((RES(I,J),J=1,4),I=4,7)
  525   FORMAT(///,(9X,4F12.6))
	READ(1,530) (RES(8,J),J=1,4)
  530   FORMAT(10X,4D12.4)
	READ(1,535) ((RES(I,J),J=1,4),I=9,12)
  535   FORMAT(9X,4F12.6)
	READ(1,530) (RES(13,J),J=1,4)
	READ(1,535) (RES(14,J),J=1,4)
	READ(1,530) (RES(15,J),J=1,4)
	READ(1,540) RES(16,1),(RES(16,J),J=3,4)
  540   FORMAT(9X,F12.6,12X,2F12.6)
	READ(1,535) ((RES(I,J),J=1,4),I=17,18)
	READ(1,545) ((RES(I,J),J=3,3),I=19,20)
  545   FORMAT(33X,1F12.6)
	READ(1,550) ((RES(I,J),J=1,3),I=21,32)
  550   FORMAT(///,(9X,3F12.4))
	READ(1,555) (RES(33,J),J=1,3)
  555   FORMAT(///,9X,3D12.4)
	READ(1,560) ((RES(I,J),J=1,3),I=34,45)
  560   FORMAT(///,(9X,3D12.4))
	READ(1,565) RES(41,1)
  565   FORMAT(9X,D12.4)
	READ(1,570) RES(47,1),RES(47,2),(RES(47,J),J=4,5)
  570   FORMAT(///,9X,2D12.4,12X,2D12.4)
	READ(1,575) (RES(I,1),RES(I,2),(RES(I,J),J=4,5),I=48,59)
  575   FORMAT(///,(9X,2D12.4,12X,2D12.4))
	READ(1,580) RES(60,1)
  580   FORMAT(9X,D12.4)
	READ(1,585) ((RES(I,J),J=1,3),I=61,72)
  585   FORMAT(///,(9X,3D12.4))
	READ(1,590) ((RES(I,J),J=1,3),I=73,84)
  590   FORMAT(///,(9X,3D12.4))
C
	WRITE(2,600) (RES(IWR(KWR),JWR(KWR)),KWR=1,NWR)
  600   FORMAT(8E16.8)
C
	GO TO 500
C
  900   CONTINUE
	STOP
	END
C
	SUBROUTINE SELEC (VNAME1,VNAME2,IWR,JWR,*,*)
C
	INTEGER IWR,JWR
	CHARACTER*5 VNAME1,VNAME2
C
  110   IWR=1
	IF(VNAME1.EQ.'time') THEN
	JWR=1
	ELSE IF(VNAME1.EQ.'l') THEN
	JWR=2
	ELSE IF(VNAME1.EQ.'chvl') THEN
	JWR=3
	ELSE IF(VNAME1.EQ.'clvl') THEN
	JWR=4
	ELSE IF(VNAME1.EQ.'ae') THEN
	JWR=5
	ELSE
	GO TO 115
	ENDIF
	GO TO 800
C
  115   IWR=2
	IF(VNAME1.EQ.'vm') THEN
	JWR=1
	ELSE IF(VNAME1.EQ.'ve') THEN
	JWR=2
	ELSE IF(VNAME1.EQ.'vi') THEN
	JWR=3
	ELSE IF(VNAME1.EQ.'vs') THEN
	JWR=4
	ELSE
	GO TO 120
	ENDIF
	GO TO 800
C
  120   IWR=3
	IF(VNAME1.EQ.'pm') THEN
	JWR=1
	ELSE IF(VNAME1.EQ.'pe') THEN
	JWR=2
	ELSE IF(VNAME1.EQ.'pi') THEN
	JWR=3
	ELSE IF(VNAME1.EQ.'ps') THEN
	JWR=4
	ELSE
	GO TO 125
	ENDIF
	GO TO 800
C
  125   IWR=4
	IF(VNAME1.EQ.'cm') THEN
	JWR=1
	ELSE IF(VNAME1.EQ.'ce') THEN
	JWR=2
	ELSE IF(VNAME1.EQ.'ci') THEN
	JWR=3
	ELSE IF(VNAME1.EQ.'cs') THEN
	JWR=4
	ELSE
	GO TO 130
	ENDIF
	GO TO 200
C
  130   IWR=21
	IF(VNAME1.EQ.'xm') THEN
	JWR=1
	ELSE IF(VNAME1.EQ.'xe') THEN
	JWR=2
	ELSE IF(VNAME1.EQ.'xi') THEN
	JWR=3
	ELSE IF(VNAME1.EQ.'xs') THEN
	JWR=4
	ELSE
	GO TO 135
	ENDIF
	GO TO 200
C
  135   IWR=33
	IF(VNAME1.EQ.'fivm') THEN
	JWR=1
	ELSE IF(VNAME1.EQ.'jv') THEN
	JWR=2
	ELSE IF(VNAME1.EQ.'fivs') THEN
	JWR=3
	ELSE
	GO TO 140
	ENDIF
	GO TO 800
C
  140   IWR=34
	IF(VNAME1.EQ.'fikm') THEN
	JWR=1
	ELSE IF(VNAME1.EQ.'jk') THEN
	JWR=2
	ELSE IF(VNAME1.EQ.'fiks') THEN
	JWR=3
	ELSE
	GO TO 145
	ENDIF
	GO TO 200
C
  145   IWR=47
	IF(VNAME1.EQ.'fevm') THEN
	JWR=1
	ELSE IF(VNAME1.EQ.'fevs') THEN
	JWR=2
	ELSE IF(VNAME1.EQ.'qev') THEN
	JWR=4
	ELSE IF(VNAME1.EQ.'qiv') THEN
	JWR=5
	ELSE
	GO TO 150
	ENDIF
	GO TO 800
C
  150   IWR=48
	IF(VNAME1.EQ.'fekm') THEN
	JWR=1
	ELSE IF(VNAME1.EQ.'feks') THEN
	JWR=2
	ELSE IF(VNAME1.EQ.'qe') THEN
	JWR=4
	ELSE IF(VNAME1.EQ.'qi') THEN
	JWR=5
	ELSE
	GO TO 155
	ENDIF
	GO TO 200
C
  155   IWR=61
	IF(VNAME1.EQ.'cikm') THEN
	JWR=1
	ELSE IF(VNAME1.EQ.'cjk') THEN
	JWR=2
	ELSE IF(VNAME1.EQ.'ciks') THEN
	JWR=3
	ELSE
	GO TO 160
	ENDIF
	GO TO 200
C
  160   IWR=73
	IF(VNAME1.EQ.'pikm') THEN
	JWR=1
	ELSE IF(VNAME1.EQ.'pjk') THEN
	JWR=2
	ELSE IF(VNAME1.EQ.'piks') THEN
	JWR=3
	ELSE
	PRINT 165
  165   FORMAT (' NO SUCH VNAME1')
	RETURN 2
	ENDIF
	GO TO 200
C
  200   CONTINUE
C
	IF(VNAME2.EQ.'na') THEN
	IWR=IWR+0
	ELSE IF(VNAME2.EQ.'k') THEN
	IWR=IWR+1
	ELSE IF(VNAME2.EQ.'cl') THEN
	IWR=IWR+2
	ELSE IF(VNAME2.EQ.'hco3') THEN
	IWR=IWR+3
	ELSE IF(VNAME2.EQ.'h2co3') THEN
	IWR=IWR+4
	ELSE IF(VNAME2.EQ.'co2') THEN
	IWR=IWR+5
	ELSE IF(VNAME2.EQ.'hpo4') THEN
	IWR=IWR+6
	ELSE IF(VNAME2.EQ.'h2po4') THEN
	IWR=IWR+7
	ELSE IF(VNAME2.EQ.'urea') THEN
	IWR=IWR+8
	ELSE IF(VNAME2.EQ.'nh3') THEN
	IWR=IWR+9
	ELSE IF(VNAME2.EQ.'nh4') THEN
	IWR=IWR+10
	ELSE IF(VNAME2.EQ.'h') THEN
	IWR=IWR+11
	ELSE IF(VNAME2.EQ.'imp') THEN
	IWR=IWR+12
	ELSE IF(VNAME2.EQ.'cur') THEN
	IWR=IWR+12
	ELSE IF(VNAME2.EQ.'osm') THEN
	IWR=IWR+13
	ELSE IF(VNAME2.EQ.'ph') THEN
	IWR=IWR+14
	ELSE IF(VNAME2.EQ.'cbuf') THEN
	IWR=IWR+15
	ELSE IF(VNAME2.EQ.'hcbuf') THEN
	IWR=IWR+16
	ENDIF
C
  800   RETURN
	END
C
