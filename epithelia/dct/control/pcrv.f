	PROGRAM PCRV
C PROGRAM TO CREATE THE PARAM.DAT FILE FOR EXECUTION OF COMP
C   PARAMETERS ARE READ FROM THE TEMPLATE FILE PARAM.TEM 
C
	INTEGER SOLS,TAU,TLIM
C
C GENERAL PARAMETERS
	DOUBLE PRECISION
     1   EPSI,KHY(4),KDHY(4),L0,
     1   AME,AE0,MUA,CHVL0,MUV,
     1   LPME,LPES,SME(12),SES(12),HME(12),HES(12),
     1   AIE(3),AI0(3),CLVL0(3),IMP0(3),
     1   ZIMP(3),TBUF(3),PKB(3),
     1   LPMI(3),LPIS(3),SMI(3,12),SIS(3,12),HMI(3,12),HIS(3,12),
     1   NP(3),KNH4(3),NPHK(3),LHP(3),XIHP(3),XHP(3),NAE1(3)
C
	INTEGER  
     1   NMI(3),ORDMI(3,6),IMI(3,6,6),JMI(3,6,6),MMI(3,6,6),
     1   NIS(3),ORDIS(3,6),IIS(3,6,6),JIS(3,6,6),MIS(3,6,6)
	DOUBLE PRECISION RMI(3,6),RIS(3,6),
     1   HCON(10),HCON0(10),DHCON(10,4),CON(4),CON0(10,4)
C
	double precision dlis
C
	OPEN (18,FILE='abs.dat')
	OPEN (19,FILE='param.tem')
	OPEN (20,FILE='param.dat')
C
	SOLS=12
C
C  SOLUTE INDEX:
C	1-	NA+
C	2-	K+
C	3-	CL-
C	4-	HCO3-
C	5-	H2CO3
C	6-	CO2
C	7-	HPO4--
C	8-	H2PO4-
C	9-	UREA
C	10-	NH3
C	11-	NH4+
C	12-	H+
C
C GEOMETRIC AND MEMBRANE PROPERTIES ARE READ. 
C
C LIE WILL CONTAIN THE CONDUCTANCE COMPONENT OF LIS
C 7/29/91- IN THE OLDER VERSIONS THE DIAGONAL LMI AND LIS WERE FIRST READ
C AND THEN THE COUPLING COEFFICIENTS.  NOW EACH COTRANSPORTER IS READ IN
C COEFFICIENT BY COEFFICIENT.  THIS ALLOWS MULTIPLE TRANSPORTERS TO SHARE
C A SINGLE SPECIES WITHOUT HAVING TO BACK-CALCULATE THE COUPLING COEFFICIENTS.
C
C
C GEOMETRIC AND MEMBRANE PROPERTIES ARE READ. 
C
	READ (19,30) TAU,TLIM,EPSI,
     1  AME,AE0,MUA,KHY(4),KDHY(4),
     1  L0,CHVL0,MUV,LPME,LPES,
     1  (SME(I),SES(I),HME(I),HES(I),I=1,SOLS)
   30   FORMAT (2I5,D12.4,/,5D12.4,/,5D12.4,/,(2F6.3, 2D12.4))
C
	DO 50 K=2,2
	READ (19,25)
     1  AIE(K),AI0(K),CLVL0(K),IMP0(K),ZIMP(K),
     1  KHY(K),KDHY(K),TBUF(K),PKB(K),
     1  NP(K),KNH4(K),NPHK(K),
     1  LHP(K),XIHP(K),XHP(K),NAE1(K)
	READ (19,26)
     1  LPMI(K),LPIS(K),
     1  (SMI(K,I),SIS(K,I),HMI(K,I),HIS(K,I),I=1,SOLS)
   25   FORMAT (5D12.4,/,4D12.4,/,3D12.4,/,4D12.4)
   26   FORMAT (2D12.4,/,(2F6.3, 2D12.4))
C
C
	READ(19,31) NMI(K),NIS(K)
	IF(NMI(K).EQ.0) GO TO 36
	DO 44 LL=1,NMI(K)
	READ(19,42) ORDMI(K,LL),RMI(K,LL)
	DO 44 KK=1,ORDMI(K,LL)
   44   READ(19,31) IMI(K,KK,LL),JMI(K,KK,LL),MMI(K,KK,LL)
C
   36   IF(NIS(K).EQ.0) GO TO 48
	DO 46 LL=1,NIS(K)
	READ(19,42) ORDIS(K,LL),RIS(K,LL)
	DO 46 KK=1,ORDIS(K,LL)
   46   READ(19,31) IIS(K,KK,LL),JIS(K,KK,LL),MIS(K,KK,LL)
   31   FORMAT (3I5)
C
C
   48   DO 49 I=1,7
   49   READ(20,47) (CON0(I,J),J=1,4)
   47   FORMAT (4D12.4)
	DO 52 I=1,7
   52   READ(20,51) (DHCON(I,J),J=1,4)
   51   FORMAT (4F7.3)
C
   50   CONTINUE
C
C
	PRINT 60
   60   FORMAT(' NUMBER OF PARAMETER SETS NEEDED=',$)
	READ *, NSETS
C
	dlis=pmi(2,1)/float(nsets)
	dhmi=hmi(2,1)/float(nsets)
C
C
	DO 200 KSETS=1,NSETS+1
C
C
C	hmi(2,3)=float(ksets)*dlis
	pmi(2,1)=float(nsets+1-ksets)*dlis
	pmi(2,2)=float(nsets+1-ksets)*dlis
	pmi(2,3)=float(nsets+1-ksets)*dlis
	hmi(2,1)=float(nsets+1-ksets)*dhmi
C	pis(2,10)=float(ksets)*dlis
C	pis(2,11)=float(ksets)*dlis
C	pis(2,12)=float(ksets)*dlis
C
	WRITE (20,130) TAU,TLIM,EPSI,
     1  AME,AE0,MUA,KHY(4),KDHY(4),
     1  L0,CHVL0,MUV,LPME,LPES,
     1  (SME(I),SES(I),HME(I),HES(I),I=1,SOLS)
  130   FORMAT (2I5,D12.4,/,5D12.4,/,5D12.4,/,(2F6.3, 2D12.4))
C
	DO 150 K=2,2
	WRITE (20,125)
     1  AIE(K),AI0(K),CLVL0(K),IMP0(K),ZIMP(K),
     1  KHY(K),KDHY(K),TBUF(K),PKB(K),
     1  NP(K),KNH4(K),NPHK(K),
     1  LHP(K),XIHP(K),XHP(K),NAE1(K)
	WRITE (20,126)
     1  LPMI(K),LPIS(K),
     1  (SMI(K,I),SIS(K,I),HMI(K,I),HIS(K,I),I=1,SOLS)
  125   FORMAT (5D12.4,/,4D12.4,/,3D12.4,/,4D12.4)
  126   FORMAT (2D12.4,/,(2F6.3, 2D12.4))
C
C
	WRITE(20,131) NMI(K),NIS(K)
	IF(NMI(K).EQ.0) GO TO 136
	DO 144 LL=1,NMI(K)
	WRITE(20,142) ORDMI(K,LL),RMI(K,LL)
	DO 144 KK=1,ORDMI(K,LL)
  144   WRITE(20,31) IMI(K,KK,LL),JMI(K,KK,LL),MMI(K,KK,LL)
C
  136   IF(NIS(K).EQ.0) GO TO 148
	DO 146 LL=1,NIS(K)
	WRITE(20,142) ORDIS(K,LL),RIS(K,LL)
	DO 146 KK=1,ORDIS(K,LL)
  146   WRITE(20,31) IIS(K,KK,LL),JIS(K,KK,LL),MIS(K,KK,LL)
  131   FORMAT (3I5)
C
C
  148   DO 149 I=1,7
  149   READ(20,147) (CON0(I,J),J=1,4)
  147   FORMAT (4D12.4)
	DO 152 I=1,7
  152   READ(20,151) (DHCON(I,J),J=1,4)
  151   FORMAT (4F7.3)
C
  150   CONTINUE
C
	write (18,199) hmi(2,1)/(float(nsets)*dhmi)
  199   format (d16.8)
  200   CONTINUE
	STOP
	END
