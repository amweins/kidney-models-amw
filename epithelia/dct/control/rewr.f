	PROGRAM REWR
C  PROGRAM TO READ A FILE TO BE SPECIFIED AT RUNTIME
C
C
	INTEGER NWR,IWR(40),JWR(40)
	REAL RES(85,9)
C
	CHARACTER*12 VNAME1,VNAME2,SW
	CHARACTER*15 IPTFIL,OPTFIL
C
	PRINT 2
    2   FORMAT(' PRINT THE INPUT FILENAME:',$)
	READ 4, IPTFIL
	PRINT 6
    6   FORMAT(' PRINT THE OUTPUT FILENAME:',$)
	READ 4, OPTFIL
    4   FORMAT (A15)
C
	OPEN(1,FILE=IPTFIL)
	OPEN(2,FILE=OPTFIL)
C
	PRINT 10
   10   FORMAT(' PRINT THE NUMBER OF VARIABLES TO BE REWRITTEN')
	READ *, NWR
	DO 800 KWR=1,NWR
   18   PRINT 20, KWR
   20   FORMAT(' PRINT THE NAME OF VARIABLE NUMBER-',I2)
	READ 30, VNAME1
   30   FORMAT(A12)
C
  110   IWR(KWR)=1
	IF(VNAME1.EQ.'time') THEN
	JWR(KWR)=1
	ELSE IF(VNAME1.EQ.'l') THEN
	JWR(KWR)=2
	ELSE IF(VNAME1.EQ.'chvl') THEN
	JWR(KWR)=3
	ELSE IF(VNAME1.EQ.'clvl') THEN
	JWR(KWR)=4
	ELSE IF(VNAME1.EQ.'ae') THEN
	JWR(KWR)=5
	ELSE
	GO TO 115
	ENDIF
	GO TO 800
C
  115   IWR(KWR)=2
	IF(VNAME1.EQ.'vm') THEN
	JWR(KWR)=1
	ELSE IF(VNAME1.EQ.'ve') THEN
	JWR(KWR)=2
	ELSE IF(VNAME1.EQ.'vi') THEN
	JWR(KWR)=3
	ELSE IF(VNAME1.EQ.'vs') THEN
	JWR(KWR)=4
	ELSE
	GO TO 120
	ENDIF
	GO TO 800
C
  120   IWR(KWR)=3
	IF(VNAME1.EQ.'pm') THEN
	JWR(KWR)=1
	ELSE IF(VNAME1.EQ.'pe') THEN
	JWR(KWR)=2
	ELSE IF(VNAME1.EQ.'pi') THEN
	JWR(KWR)=3
	ELSE IF(VNAME1.EQ.'ps') THEN
	JWR(KWR)=4
	ELSE
	GO TO 125
	ENDIF
	GO TO 800
C
  125   IWR(KWR)=4
	IF(VNAME1.EQ.'cm') THEN
	JWR(KWR)=1
	ELSE IF(VNAME1.EQ.'ce') THEN
	JWR(KWR)=2
	ELSE IF(VNAME1.EQ.'ci') THEN
	JWR(KWR)=3
	ELSE IF(VNAME1.EQ.'cs') THEN
	JWR(KWR)=4
	ELSE
	GO TO 130
	ENDIF
	GO TO 200
C
  130   IWR(KWR)=21
	IF(VNAME1.EQ.'xm') THEN
	JWR(KWR)=1
	ELSE IF(VNAME1.EQ.'xe') THEN
	JWR(KWR)=2
	ELSE IF(VNAME1.EQ.'xi') THEN
	JWR(KWR)=3
	ELSE IF(VNAME1.EQ.'xs') THEN
	JWR(KWR)=4
	ELSE
	GO TO 135
	ENDIF
	GO TO 200
C
  135   IWR(KWR)=33
	IF(VNAME1.EQ.'fivm') THEN
	JWR(KWR)=1
	ELSE IF(VNAME1.EQ.'jv') THEN
	JWR(KWR)=2
	ELSE IF(VNAME1.EQ.'fivs') THEN
	JWR(KWR)=3
	ELSE
	GO TO 140
	ENDIF
	GO TO 800
C
  140   IWR(KWR)=34
	IF(VNAME1.EQ.'fikm') THEN
	JWR(KWR)=1
	ELSE IF(VNAME1.EQ.'jk') THEN
	JWR(KWR)=2
	ELSE IF(VNAME1.EQ.'fiks') THEN
	JWR(KWR)=3
	ELSE
	GO TO 145
	ENDIF
	GO TO 200
C
  145   IWR(KWR)=47
	IF(VNAME1.EQ.'fevm') THEN
	JWR(KWR)=1
	ELSE IF(VNAME1.EQ.'fevs') THEN
	JWR(KWR)=2
	ELSE IF(VNAME1.EQ.'qev') THEN
	JWR(KWR)=4
	ELSE IF(VNAME1.EQ.'qiv') THEN
	JWR(KWR)=5
	ELSE
	GO TO 150
	ENDIF
	GO TO 800
C
  150   IWR(KWR)=48
	IF(VNAME1.EQ.'fekm') THEN
	JWR(KWR)=1
	ELSE IF(VNAME1.EQ.'feks') THEN
	JWR(KWR)=2
	ELSE IF(VNAME1.EQ.'qe') THEN
	JWR(KWR)=4
	ELSE IF(VNAME1.EQ.'qi') THEN
	JWR(KWR)=5
	ELSE
	GO TO 155
	ENDIF
	GO TO 200
C
  155   IWR(KWR)=61
	IF(VNAME1.EQ.'cikm') THEN
	JWR(KWR)=1
	ELSE IF(VNAME1.EQ.'cjk') THEN
	JWR(KWR)=2
	ELSE IF(VNAME1.EQ.'ciks') THEN
	JWR(KWR)=3
	ELSE
	GO TO 160
	ENDIF
	GO TO 200
C
  160   IWR(KWR)=73
	IF(VNAME1.EQ.'pikm') THEN
	JWR(KWR)=1
	ELSE IF(VNAME1.EQ.'pjk') THEN
	JWR(KWR)=2
	ELSE IF(VNAME1.EQ.'piks') THEN
	JWR(KWR)=3
	ELSE
	PRINT 165
  165   FORMAT (' NO SUCH VNAME1')
	GO TO 18
	ENDIF
	GO TO 200
C
C
  200   PRINT 201
  201   FORMAT(' PRINT THE SPECIES')
	READ 30, VNAME2
C
	IF(VNAME2.EQ.'na') THEN
	IWR(KWR)=IWR(KWR)+0
	ELSE IF(VNAME2.EQ.'k') THEN
	IWR(KWR)=IWR(KWR)+1
	ELSE IF(VNAME2.EQ.'cl') THEN
	IWR(KWR)=IWR(KWR)+2
	ELSE IF(VNAME2.EQ.'hco3') THEN
	IWR(KWR)=IWR(KWR)+3
	ELSE IF(VNAME2.EQ.'h2co3') THEN
	IWR(KWR)=IWR(KWR)+4
	ELSE IF(VNAME2.EQ.'co2') THEN
	IWR(KWR)=IWR(KWR)+5
	ELSE IF(VNAME2.EQ.'hpo4') THEN
	IWR(KWR)=IWR(KWR)+6
	ELSE IF(VNAME2.EQ.'h2po4') THEN
	IWR(KWR)=IWR(KWR)+7
	ELSE IF(VNAME2.EQ.'urea') THEN
	IWR(KWR)=IWR(KWR)+8
	ELSE IF(VNAME2.EQ.'nh3') THEN
	IWR(KWR)=IWR(KWR)+9
	ELSE IF(VNAME2.EQ.'nh4') THEN
	IWR(KWR)=IWR(KWR)+10
	ELSE IF(VNAME2.EQ.'h') THEN
	IWR(KWR)=IWR(KWR)+11
	ELSE IF(VNAME2.EQ.'imp') THEN
	IWR(KWR)=IWR(KWR)+12
	ELSE IF(VNAME2.EQ.'cur') THEN
	IWR(KWR)=IWR(KWR)+12
	ELSE IF(VNAME2.EQ.'osm') THEN
	IWR(KWR)=IWR(KWR)+13
	ELSE IF(VNAME2.EQ.'ph') THEN
	IWR(KWR)=IWR(KWR)+14
	ELSE IF(VNAME2.EQ.'cbuf') THEN
	IWR(KWR)=IWR(KWR)+15
	ELSE IF(VNAME2.EQ.'hcbuf') THEN
	IWR(KWR)=IWR(KWR)+16
	ENDIF
C
  800   CONTINUE
C
C
	PRINT 290
  290   FORMAT(' IS THIS A TRANSIENT (TR) OR STEADY STATE (SS) EXPT.')
	READ 292, SW
  292   FORMAT(A2)
C
C
  300   READ(1,310,END=900) (RES(1,J),J=1,5)
  310   FORMAT (64(/),10X,F9.4,////,6X,4D12.4)
	READ(1,315) (RES(2,J),J=1,4)
  315   FORMAT(///,8X,4F12.3)
	READ(1,320) (RES(3,J),J=1,4)
  320   FORMAT(///,8X,4F12.3)
	READ(1,325) ((RES(I,J),J=1,4),I=4,7)
  325   FORMAT(///,(9X,4F12.6))
	READ(1,330) (RES(8,J),J=1,4)
  330   FORMAT(10X,4D12.4)
	READ(1,335) ((RES(I,J),J=1,4),I=9,12)
  335   FORMAT(9X,4F12.6)
	READ(1,330) (RES(13,J),J=1,4)
	READ(1,335) (RES(14,J),J=1,4)
	READ(1,330) (RES(15,J),J=1,4)
	READ(1,340) RES(16,1),(RES(16,J),J=3,4)
  340   FORMAT(9X,F12.6,12X,2F12.6)
	READ(1,335) ((RES(I,J),J=1,4),I=17,18)
	READ(1,345) ((RES(I,J),J=3,3),I=19,20)
  345   FORMAT(33X,1F12.6)
	READ(1,350) ((RES(I,J),J=1,3),I=21,32)
  350   FORMAT(///,(9X,3F12.4,))
	READ(1,355) (RES(33,J),J=1,3)
  355   FORMAT(///,9X,3D12.4)
	READ(1,360) ((RES(I,J),J=1,3),I=34,45)
  360   FORMAT(///,(9X,3D12.4))
	READ(1,365) RES(41,1)
  365   FORMAT(9X,D12.4)
	READ(1,370) RES(47,1),RES(47,2),(RES(47,J),J=4,5)
  370   FORMAT(///,9X,2D12.4,12X,2D12.4)
	READ(1,375) (RES(I,1),RES(I,2),(RES(I,J),J=4,5),I=48,59)
  375   FORMAT(///,(9X,2D12.4,12X,2D12.4))
	READ(1,380) RES(60,1)
  380   FORMAT(9X,D12.4)
	READ(1,385) ((RES(I,J),J=1,3),I=61,72)
  385   FORMAT(///,(9X,3D12.4))
	READ(1,390) ((RES(I,J),J=1,3),I=73,84)
  390   FORMAT(///,(9X,3D12.4))
C
C
	WRITE(2,400) (RES(IWR(KWR),JWR(KWR)),KWR=1,NWR)
  400   FORMAT(8E16.8)
C
	IF(SW.EQ.'ss') GO TO 300
C
  500   READ(1,510,END=900) (RES(1,J),J=1,5)
  510   FORMAT (/,10X,F9.4,////,6X,4D12.4)
	READ(1,515) (RES(2,J),J=1,4)
  515   FORMAT(///,8X,4F12.3)
	READ(1,520) (RES(3,J),J=1,4)
  520   FORMAT(///,8X,4F12.3)
	READ(1,525) ((RES(I,J),J=1,4),I=4,7)
  525   FORMAT(///,(9X,4F12.6))
	READ(1,530) (RES(8,J),J=1,4)
  530   FORMAT(10X,4D12.4)
	READ(1,535) ((RES(I,J),J=1,4),I=9,12)
  535   FORMAT(9X,4F12.6)
	READ(1,530) (RES(13,J),J=1,4)
	READ(1,535) (RES(14,J),J=1,4)
	READ(1,530) (RES(15,J),J=1,4)
	READ(1,540) RES(16,1),(RES(16,J),J=3,4)
  540   FORMAT(9X,F12.6,12X,2F12.6)
	READ(1,535) ((RES(I,J),J=1,4),I=17,18)
	READ(1,545) ((RES(I,J),J=3,3),I=19,20)
  545   FORMAT(33X,1F12.6)
	READ(1,550) ((RES(I,J),J=1,3),I=21,32)
  550   FORMAT(///,(9X,3F12.4,))
	READ(1,555) (RES(33,J),J=1,3)
  555   FORMAT(///,9X,3D12.4)
	READ(1,560) ((RES(I,J),J=1,3),I=34,45)
  560   FORMAT(///,(9X,3D12.4))
	READ(1,565) RES(41,1)
  565   FORMAT(9X,D12.4)
	READ(1,570) RES(47,1),RES(47,2),(RES(47,J),J=4,5)
  570   FORMAT(///,9X,2D12.4,12X,2D12.4)
	READ(1,575) (RES(I,1),RES(I,2),(RES(I,J),J=4,5),I=48,59)
  575   FORMAT(///,(9X,2D12.4,12X,2D12.4))
	READ(1,580) RES(60,1)
  580   FORMAT(9X,D12.4)
	READ(1,585) ((RES(I,J),J=1,3),I=61,72)
  585   FORMAT(///,(9X,3D12.4))
	READ(1,590) ((RES(I,J),J=1,3),I=73,84)
  590   FORMAT(///,(9X,3D12.4))
C
	WRITE(2,600) (RES(IWR(KWR),JWR(KWR)),KWR=1,NWR)
  600   FORMAT(8E16.8)
C
	GO TO 500
C
  900   CONTINUE
	STOP
	END
