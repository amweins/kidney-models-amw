	SUBROUTINE OMARESA
C
	INTEGER SOLS,X,T,ITER,CHOP
C
	DOUBLE PRECISION
     1   Z(15),ZIMPC,RT,RTE,F,
     1   EPSI,SCALE,DT,RTAU,TIME,DIST,
     1   PKC,PKP,PKN,PKF,KHY,KDHY,
     1   LPCS,SCS(15),LCS(15),HCS(15),
     1   LPCSE,SCSE(15),LCSE(15),HCSE(15),
     1   LPCSI,SCSI(15),LCSI(15),HCSI(15),
     1   CL,DX,RC0,MUC,ETA,
     1   KXO,KXD,KYO,KYD,
     1   KCO,KCD,KZO,KZD,
     1   A0,A1,A2,P50,HILL,BOHR
C 
	DOUBLE PRECISION
     1   VC(901,2),PC(901,2),CC(31,901,2),IMPC(901,2),
     1   LCHC(901),XC(15,901),
     1   VS(901,2),PS(901,2),CS(16,901,2),
     1   IMPS(901,2),LCHS(901),XS(15,901),
     1   CCS(15),SAT(901,2),CCN(901,2),CCX(901,2),CCY(901,2),
     1   SC(901,2),AC(901,2),FVC(901,2),FKC(31,901,2),
     1   QV,QC(31),FVCS(901,2),FKCS(16,901,2),
     1   FVCSE(901,2),FKCSE(16,901,2),FVCSI(901,2),FKCSI(16,901,2),
     1   HCTC(901,2),FBC(901,2),POX(901,2)
C
	DOUBLE PRECISION SC0,AC0,KF
        CHARACTER*5 SOL(15)
C
C
	COMMON/PARVR/ SOLS,T,X,CHOP,
     1   Z,ZIMPC,RT,RTE,F,
     1   EPSI,SCALE,DT,RTAU,TIME,DIST,
     1   PKC,PKP,PKN,PKF,KHY,KDHY,
     1   LPCS,SCS,LCS,HCS,
     1   LPCSE,SCSE,LCSE,HCSE,
     1   LPCSI,SCSI,LCSI,HCSI,
     1   CL,DX,RC0,MUC,ETA,
     1   KXO,KXD,KYO,KYD,
     1   KCO,KCD,KZO,KZD,
     1   A0,A1,A2,P50,HILL,BOHR
	COMMON/VARVR/
     1   VC,PC,CC,VS,PS,CS,IMPC,IMPS,
     1   LCHC,LCHS,XC,XS,CCS,
     1   SAT,CCN,CCX,CCY,HCTC,FBC,POX,
     1   SC,AC,FVC,FKC,QC,QV,FVCS,FKCS,
     1   FVCSE,FKCSE,FVCSI,FKCSI
C
C
	SOL(1)='  NA '
	SOL(2)='  K  '
	SOL(3)='  CL '
	SOL(4)=' HCO3'
	SOL(5)='H2CO3'
	SOL(6)=' CO2 '
	SOL(7)=' HPO4'
	SOL(8)='H2PO4'
	SOL(9)=' UREA'
	SOL(10)=' NH3 '
	SOL(11)=' NH4+'
	SOL(12)='  H+ '
	SOL(13)='HCO2-'
	SOL(14)='H2CO2'
	SOL(15)=' GLUC'
C
	AC0=AC(1,1)/SCALE
	SC0=SC(1,1)/SCALE
	ETA=ETA/SCALE
	KF=LPCS*SC0*CL
C
C THIS IS A STEADY STATE SOLUTION
C     OR THE FIRST PASS OF A TIMED EXPERIMENT
C
	DO 365 I=1,SOLS
C
  354   CCS(I)=(CC(I,X,T)-CS(I,X,T))
	IF (CCS(I)) 356,355,356
  355   CCS(I)=CS(I,X,T)
	GO TO 360
  356   CCS(I)=CCS(I)/DLOG(CC(I,X,T)/CS(I,X,T))
C
  360   LCS(I)=HCS(I)*CCS(I)/RTE
  365   CONTINUE
C
C
	WRITE (213,363) RT,RTE,F,A0,A1,A2,
     1  RC0,SC0,AC0,MUC,ETA
	WRITE (213,364) PKC,PKP,PKN,PKF,KXO,KXD,
     1  KYO,KYD,KCO,KCD,KZO,KZD
	WRITE (213,361) LPCS,KF,
     1  (SOL(I),SCS(I),HCS(I),LCS(I),I=1,SOLS)
  363   FORMAT (1H1,///,5X,'RT=',1PD10.2,5X,'RTE=',
     1  0PF7.4,5X,'F=',1PD10.2,10X,
     1  'A0=',0PF6.3,5X,'A1=',F6.3,5X,'A2=',F6.3,5X,
     1  //,10X,'RC0=',F7.5,5X,'SC0=',F7.5,5X,'AC0=',1PD12.4,
     1  10X,'MUC=',0PF6.3,5X,'ETA=',1PD10.2)
  364   FORMAT (///,10X,
     1  'PKC=',F4.2,7X,'PKP=',F4.2,7X,'PKN=',F4.2,7X,'PKF=',F4.2,/,
     1  61X,'KXO=',1PD10.2,7X,'KXD=',D10.2,/,
     1  61X,'KYO=',D10.2,7X,'KYD=',D10.2,/,
     1  61X,'KCO=',D10.2,7X,'KCD=',D10.2,/,
     1  61X,'KDO=',D10.2,7X,'KZD=',D10.2)
  361   FORMAT (///,15X,'LPCS=',1PD12.2,7X,'KF=',D12.4,
     1  ///,16X,'SCS',9X,'HCS',9X,'LCS',9X,/,(4X,A5,1X,3D12.4))
C
	ETA=ETA*SCALE
C
 	RETURN
	END
