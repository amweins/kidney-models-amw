	SUBROUTINE GEN(SWJ)
C
C PROGRAM TO SUM THE NEXT EXPORT OF VOLUME AND SOLUTE AT EACH MEDULLARY LEVEL
C  SINCE THERE IS A CONING OF NEPHRONS THE PROGRAM TRANSFORMS 2-D DATA TO A VECTOR
C
C THE ARCHIVED DATA CONTAINS FLOWS/FLUXES FOR TUBULE SEGMENTS - 
C   WHICH ARE SCALED UP ACCORDING TO NEPHRON NUMBER 
C    (CONTRAST TO VASC CODE, IN WHICH ARCHIVES HOLD ONLY INDIVIDUAL VESSEL FLUXES)
C
C  Calculation plan: 
C  SFPCT -> SFPST -> SDHL -> AHLm -> AHLc -> DCT
C  JMPCT -> JMPST -> LDHLu -> LDHLl(2-6) -> tAHL(2-6) -> AHLm(2-6) -> AHLc(2-6) -> DCT(2-6)
C  Merged DCT -> CNT -> CCD -> OMCD -> IMCD
C 
C 12/22/12 - ARCHIVAL VARIABLES ADDED IN ANTICIPATION OF MULTIPLE NEPHRONS
C THERE ARE TWO MEASURES OF DISTANCE ALONG THE NEPHRON:
C    X IS AN INTEGER VARIABLE, AND WILL NOW BE ZEROED WITH EACH SEGMENT
C    DIST IS A REAL VARIABLE THAT TRACKS DISTANCE ALONG THE NEPHRON
C    ALTHOUGH THIS WILL BECOME AMBIGUOUS AS DIFFERENT LENGTHS COALESCE IN CNT
C
C   SUBSCRIPTS (CELL TYPE,SOLUTE,DISTANCE,TIME)
C     INDICES FOR THE CELL TYPE: 1=PRINCIPAL; 2=ALPHA; 3=BETA
C
C KEY TO INDICES:
C  6 nephrons: SF (INEPH = 1) plus 5 JM (INEPH = 2-6)
C    SFPCT and SFPST in series with SDHL
C    JMPCT and JMPST in series with LDHLu and LDHLl
C  LDHLu will be restricted to OM and LDHLl to IM
C
C Plan for 24000 SF nephrons (@30 nl/min -> 720 mul/min) 
C    12400 JM nephrons (@60 nl/min -> 720 mul/min) 
C     Of the 12000 JM, turns can parallel CD coning:
C    1 mm 6400
C    2 mm 3200
C    3 mm 1600
C    4 mm  800
C    5 mm  400
C
C Segment numbers (ISEG)
C      1- PCT
C      2- PST
C      3- sDHL, lDHLu
C      4- lDHLl
C      5- tAHL
C      6- AHLm
C      7- AHLc
C      8- DCT
C      9- CNT
C      10-CCD
C      11-OMCD
C      12-IMCD
C
C **FOR THIS PROGRAM TO WORK, VARIABLES OMCHOP AND IMCHOP MUST BE WELL-DEFINED
C    CHOP(PST) + CHOP(sDHL) (=CHOP(lDHLu) = CHOP(AHLm) = CHOP(OMCD)
C    CHOP(lDHLl) = CHOP(tAHL) = CHOP(IMCD)
C    CHOP(AHLc) = CHOP(CCD)
C
	INTEGER IARCH,INEPH,ISEG
C  IARCH = 0 (ARCHIVE) 
C        = 1 (RETRIEVE EVERYTHING) 
C        = 2 (INITIALIZE THE NEXT SEGMENT)
C        = 3 (RETRIEVE EVERYTHING EXCEPT X=1 VARIABLES)
C
	INTEGER SWJ,
     1   RX(6,12), RCHOP(6,12)
C  SWJ   = 0 (no output); = 1 (output to medjs and kphi)
C
C GENERAL PARAMETERS
	DOUBLE PRECISION
     1   RDIST(6,12), REPSI(6,12), RL0(6,12),
     1   RL(6,12,901,2), RKHY(6,12,5), RKDHY(6,12,5), RBCO2(6,12,3)
C
C LUMINAL AND PERITUBULAR PARAMETERS
	DOUBLE PRECISION
     1   RVM(6,12,901,2), RPM(6,12,901,2), RCM(6,12,15,901,2),
     1   RIMPM(6,12,901,2), RLCHM(6,12,901), RXM(6,12,15,901),
     1   RVS(6,12,901,2), RPS(6,12,901,2), RCS(6,12,15,901,2),
     1   RIMPS(6,12,901,2), RLCHS(6,12,901), RXS(6,12,15,901),
     1   RTL(6,12), RDX(6,12), RRM0(6,12),
     1   RMUM(6,12), RETA(6,12), RSM(6,12,901,2),
     1   RAM(6,12,901,2), RFVM(6,12,901,2), RFKM(6,12,16,901,2)
C
C INTERSPACE PARAMETERS
	DOUBLE PRECISION
     1   RAME(6,12), RAE0(6,12), RAE(6,12,901,2),
     1   RMUA(6,12), RCHVL0(6,12), RCHVL(6,12,901,2),
     1   RMUV(6,12), RLPME(6,12), RLPES(6,12),
     1   RSME(6,12,15), RSES(6,12,15), RHME(6,12,15),
     1   RHES(6,12,15), RVE(6,12,901,2), RPE(6,12,901,2),
     1   RCE(6,12,15,901,2), RLCHE(6,12,901), RXE(6,12,15,901),
     1   RFEVM(6,12,901,2), RFEKM(6,12,15,901,2), RFEVS(6,12,901,2),
     1   RFEKS(6,12,15,901,2), RCURE(6,12,901)
C
C CELL PARAMETERS
	DOUBLE PRECISION
     1   RAIE(6,12,3), RAMI(6,12,3), RAIS(6,12,3),
     1   RAI0(6,12,3), RCLVL0(6,12,3), RIMP0(6,12,3),
     1   RCLVL(6,12,3,901,2), RZIMP(6,12,3), RTBUF(6,12,3),
     1   RPKB(6,12,3), RCBUF(6,12,3,901,2), RHCBUF(6,12,3,901,2),
     1   RLPMI(6,12,3), RLPIS(6,12,3), RSMI(6,12,3,15),
     1   RSIS(6,12,3,15), RHMI(6,12,3,15), RHIS(6,12,3,15),
     1   RLMI(6,12,3,15,15), RLIS(6,12,3,15,15), RATMI(6,12,3,15,901),
     1   RATIS(6,12,3,15,901), RATIE(6,12,3,15,901), RVI(6,12,3,901,2),
     1   RPI(6,12,3,901,2), RCI(6,12,3,15,901,2), RIMP(6,12,3,901),
     1   RLCHI(6,12,3,901), RXI(6,12,3,15,901), RFIVM(6,12,3,901,2),
     1   RFIKM(6,12,3,15,901,2), RFIVS(6,12,3,901,2), 
     1   RFIKS(6,12,3,15,901,2), RCURI(6,12,3,901), 
     1   RJV(6,12,3,901,2), RJK(6,12,3,15,901,2)
C
C SPECIAL TRANSPORTERS
	CHARACTER*1 RISOFM(6,12)
	DOUBLE PRECISION
     1   RNP(6,12,3), RKNPN(6,12,3), RKNPK(6,12,3),
     1   RKNH4(6,12,3), RNPHK(6,12,3), RLHP(6,12,3),
     1   RXIHP(6,12,3), RXHP(6,12,3), RNAE1(6,12,3),
     1   RNTSC(6,12,3), RNNHE3(6,12,3), RJNAK(6,12,3,3,901,2),
     1   RJHK(6,12,3,901,2), RJHP(6,12,3,901,2), RJAE1(6,12,3,901,2),
     1   RJTSC(6,12,3,901,2), RJNHE3(6,12,3,3,901,2), RQIAMM(6,12),
     1   RNNKCC(6,12,3), RNKCL(6,12,3), RJNKCC(6,12,3,4,901,2),
     1   RJKCC(6,12,3,3,901,2)
C
C TORQUE AND COMPLIANCE VARIABLES
	DOUBLE PRECISION
     1   RTQM(6,12,501,2), RRM(6,12,501,2), RMUR(6,12), RSCALMI(6,12),
     1   RSCALIS(6,12), RVM0(6,12), RAM0(6,12), RTQM0(6,12),
     1   RLHP0(6,12,3), RNP0(6,12,3), RNNHE30(6,12,3), RLPMI0(6,12,3),
     1   RLPIS0(6,12,3), RHMI0(6,12,3,15), RHIS0(6,12,3,15),
     1   RLMI0(6,12,3,15,15), RLIS0(6,12,3,15,15), RQIAMM0(6,12),
     1   RMVL(6,12), RMVD(6,12), RRMT0(6,12)
C
C
	INTEGER SOLS,CHOP,OMCHOP,IMCHOP,MRCHOP
C
        DOUBLE PRECISION
     1    OMDIST(901),OMJVMS(901),OMJKMS(16,901),
     1    IMDIST(901),IMJVMS(901),IMJKMS(16,901),
     1    MRDIST(901),MRJVMS(901),MRJKMS(16,901),
     1    MEDJVMS(8),MEDJKMS(16,8),DX,TJV,TJKMS(16),
     1    TV(10),TK(10,16),SEGV(6,12),SEGK(6,12,16),
     1    SLV(2),SLK(2,16)
C
        CHARACTER*8 SOL(16)
C
C VARIABLES LOCAL TO THIS SUBROUTINE:
C       DIST-  MEDULLARY DEPTH
C       JVMS-  TOTAL VOLUME FLUX FROM TUBULES TO IS (FEVS + FIVS)
C       JKMS-  TOTAL SOLUTE FLUX FROM TUBULES TO IS (FEKS + FIKS)
C       MEDJMS-SUMMATION OF FLUXES FOR EACH MM SLICE OF MEDULLA OM->TIP
C       TJJMS- SUMMATION OF THE MEDJMS ACROSS ALL SLICES
C       TJV,TJK-    TRANSPORT ACCORDING TO TUBULE (RATHER THAN SLICE)
C       SEGV,SEGK-  SEGMENTAL FLUX SUMS; COMPONENTS OF JVMS AND JKMS:
C       SLV,SLK-  OM (K=1) AND IM (K=2) FLUXES SUMMED FROM SEGV AND SEGK
C
C VARIABLES LOCAL TO VGEN
        DOUBLE PRECISION
     1    OMJVCS(901),OMJKCS(16,901),
     1    IMJVCS(901),IMJKCS(16,901),
     1    MRJVCS(901),MRJKCS(16,901),
     1    MEDJVCS(8),MEDJKCS(16,8),
     1    VSEGV(8,4),VSEGK(8,4,16)
C
	COMMON /ARCH/
     1   RX, RCHOP,
     1   RDIST, REPSI, RL0, RL, RKHY, RKDHY, RBCO2,
     1   RVM, RPM, RCM, RIMPM, RLCHM, RXM,
     1   RVS, RPS, RCS, RIMPS, RLCHS, RXS,
     1   RTL, RDX, RRM0, RMUM, RETA, RSM, RAM,
     1   RFVM, RFKM,
     1   RAME, RAE0, RAE, RMUA, RCHVL0, RCHVL,
     1   RMUV, RLPME, RLPES, RSME, RSES,
     1   RHME, RHES, RVE, RPE,
     1   RCE, RLCHE, RXE, RFEVM, RFEKM,
     1   RFEVS, RFEKS, RCURE,
     1   RAIE, RAMI, RAIS, RAI0, RCLVL0, RIMP0,
     1   RCLVL, RZIMP, RTBUF, RPKB, RCBUF, RHCBUF,
     1   RLPMI, RLPIS, RSMI, RSIS, RHMI, RHIS,
     1   RLMI, RLIS, RATMI, RATIS, RATIE, RVI, RPI,
     1   RCI, RIMP, RLCHI, RXI, RFIVM, RFIKM,
     1   RFIVS, RFIKS, RCURI, RJV, RJK, RISOFM,
     1   RNP, RKNPN, RKNPK, RKNH4, RNPHK, RLHP,
     1   RXIHP, RXHP, RNAE1, RNTSC, RNNHE3,
     1   RJNAK, RJHK, RJHP, RJAE1, RJTSC, RJNHE3,
     1   RQIAMM, RNNKCC, RNKCL, RJNKCC, RJKCC,
     1   RTQM, RRM, RMUR, RSCALMI, RSCALIS, 
     1   RVM0, RAM0, RTQM0, RLHP0, RNP0, RNNHE30,
     1   RLPMI0, RLPIS0, RHMI0, RHIS0, RLMI0, 
     1   RLIS0, RQIAMM0, RMVL, RMVD, RRMT0
C
        COMMON /KGEN/
     1    OMDIST,IMDIST,MRDIST,
     1    OMJVMS,OMJKMS,IMJVMS,IMJKMS,MRJVMS,MRJKMS,
     1    MEDJVMS,MEDJKMS,SEGV,SEGK,
     1    OMJVCS,OMJKCS,IMJVCS,IMJKCS,MRJVCS,MRJKCS,
     1    MEDJVCS,MEDJKCS,VSEGV,VSEGK
C
C
        SOLS = 15
	SOL(1)='  NA '
	SOL(2)='  K  '
	SOL(3)='  CL '
	SOL(4)=' HCO3'
	SOL(5)='H2CO3'
	SOL(6)=' CO2 '
	SOL(7)=' HPO4'
	SOL(8)='H2PO4'
	SOL(9)=' UREA'
	SOL(10)=' NH3 '
	SOL(11)=' NH4+'
	SOL(12)='  H+ '
	SOL(13)='HCO2-'
	SOL(14)='H2CO2'
	SOL(15)=' GLUC'
	SOL(16)=' PROT'
C
        DO 20 IX=1,901
          OMJVMS(IX)=0.D0
          IMJVMS(IX)=0.D0
          MRJVMS(IX)=0.D0
        DO 15 ISOL=1,16
          OMJKMS(ISOL,IX)=0.D0
          IMJKMS(ISOL,IX)=0.D0
          MRJKMS(ISOL,IX)=0.D0
   15   CONTINUE
   20   CONTINUE
C
        DO 30 ISLC=1,8
          MEDJVMS(ISLC)=0.D0
        DO 25 ISOL=1,16
          MEDJKMS(ISOL,ISLC)=0.D0
   25   CONTINUE
   30   CONTINUE
C
        DO 40 INEPH=1,6
        DO 40 ISEG=1,12
          SEGV(INEPH,ISEG)=0.D0
        DO 35 ISOL=1,16
          SEGK(INEPH,ISEG,ISOL)=0.D0
   35   CONTINUE
   40   CONTINUE
C
C  IN DHL AND BEYOND, THE SOLUTES ARE TRUNCATED TO THE FIRST 12
C    WITH HCO2- ADDED TO CL- AND GLUC BECOMING IMPM
C
C
C THE SUMMATIONS BELOW FIRST INTEGRATE OVER SEGMENT NUMBER TO GET
C  NET INTERSTITIAL FLUXES AT EACH POINT X: OMJMS(SOL,X) OR IMJMS(SOL,X)
C THEN THEY SUM OVER X WITHIN A SLICE: MEDJMS(SOL,SLICE)
C  TO DEBUG: FIRST PRESERVE THE SEGMENTAL INTEGRITY, TO COMPARE WITH VASCWR
C
C OUTER MEDULLA
C
        ISEG=2
        INEPH=1
        CHOP=RCHOP(INEPH,ISEG)
        OMDIST(1) = 0.0
	DO 110 KX=2,CHOP+1
  110   OMDIST(KX) = OMDIST(KX-1) + RTL(INEPH,ISEG)/FLOAT(CHOP)
        OMCHOP=CHOP
        ISEG=3
        CHOP=RCHOP(INEPH,ISEG)
	DO 112 KX=OMCHOP+2,OMCHOP+CHOP+1
  112   OMDIST(KX) = OMDIST(KX-1) + RTL(INEPH,ISEG)/FLOAT(CHOP)
        OMCHOP=OMCHOP+CHOP
C
C  - DESCENDING: PST (ISEG=2), sDHL or lDHLu (ISEG=3), and OMCD (ISEG=11)
C
        ISEG=2
        SOLS=15
        CHOP=RCHOP(INEPH,ISEG)
        L2=CHOP
        DO 132 INEPH=1,6
        DO 130 IX=1,CHOP+1
        OMJVMS(IX)=OMJVMS(IX)+ RSM(INEPH,ISEG,IX,1)*
     1    (RFEVS(INEPH,ISEG,IX,1)+RFIVS(INEPH,ISEG,1,IX,1))
        DO 129 ISOL=1,SOLS
  129   OMJKMS(ISOL,IX)=OMJKMS(ISOL,IX)+ RSM(INEPH,ISEG,IX,1)*
     1    (RFEKS(INEPH,ISEG,ISOL,IX,1)+RFIKS(INEPH,ISEG,1,ISOL,IX,1))
  130   CONTINUE
  132   CONTINUE
C
        DO 137 INEPH=1,6
        DX=RTL(INEPH,ISEG)/FLOAT(RCHOP(INEPH,ISEG))
        DO 135 IX=1,CHOP
        SEGV(INEPH,ISEG)=SEGV(INEPH,ISEG)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1       (RFEVS(INEPH,ISEG,IX,1)+RFIVS(INEPH,ISEG,1,IX,1))+
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1       (RFEVS(INEPH,ISEG,IX+1,1)+RFIVS(INEPH,ISEG,1,IX+1,1)) 
        DO 134 ISOL=1,SOLS
  134   SEGK(INEPH,ISEG,ISOL)=SEGK(INEPH,ISEG,ISOL)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1  (RFEKS(INEPH,ISEG,ISOL,IX,1)+RFIKS(INEPH,ISEG,1,ISOL,IX,1))+ 
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1  (RFEKS(INEPH,ISEG,ISOL,IX+1,1)+RFIKS(INEPH,ISEG,1,ISOL,IX+1,1))
  135   CONTINUE
  137   CONTINUE
C
        ISEG=3
        INEPH=1
        SOLS=12
        CHOP=RCHOP(INEPH,ISEG)
        DO 142 INEPH=1,6
        DO 140 IX=1,CHOP+1
        OMJVMS(L2+IX)=OMJVMS(L2+IX)+ RSM(INEPH,ISEG,IX,1)*
     1    (RFEVM(INEPH,ISEG,IX,1)+RFIVM(INEPH,ISEG,1,IX,1))
        DO 139 ISOL=1,SOLS
  139   OMJKMS(ISOL,L2+IX)=OMJKMS(ISOL,L2+IX)+ RSM(INEPH,ISEG,IX,1)*
     1    (RFEKM(INEPH,ISEG,ISOL,IX,1)+RFIKM(INEPH,ISEG,1,ISOL,IX,1))
  140   CONTINUE
  142   CONTINUE
C
        DO 147 INEPH=1,6
        DX=RTL(INEPH,ISEG)/FLOAT(RCHOP(INEPH,ISEG))
        DO 145 IX=1,CHOP
        SEGV(INEPH,ISEG)=SEGV(INEPH,ISEG)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1       (RFEVM(INEPH,ISEG,IX,1)+RFIVM(INEPH,ISEG,1,IX,1))+
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1       (RFEVM(INEPH,ISEG,IX+1,1)+RFIVM(INEPH,ISEG,1,IX+1,1)) 
        DO 144 ISOL=1,SOLS
  144   SEGK(INEPH,ISEG,ISOL)=SEGK(INEPH,ISEG,ISOL)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1  (RFEKM(INEPH,ISEG,ISOL,IX,1)+RFIKM(INEPH,ISEG,1,ISOL,IX,1))+ 
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1  (RFEKM(INEPH,ISEG,ISOL,IX+1,1)+RFIKM(INEPH,ISEG,1,ISOL,IX+1,1))
  145   CONTINUE
  147   CONTINUE
C
        ISEG=11
        INEPH=1
        CHOP=OMCHOP
        DO 180 IX=1,CHOP+1
        OMJVMS(IX)=OMJVMS(IX)+ RSM(INEPH,ISEG,IX,1)*
     1    (RFEVS(INEPH,ISEG,IX,1)+RFIVS(INEPH,ISEG,1,IX,1)
     1      +RFIVS(INEPH,ISEG,2,IX,1))
        DO 179 ISOL=1,SOLS
  179   OMJKMS(ISOL,IX)=OMJKMS(ISOL,IX)+ RSM(INEPH,ISEG,IX,1)*
     1    (RFEKS(INEPH,ISEG,ISOL,IX,1)+RFIKS(INEPH,ISEG,1,ISOL,IX,1)
     1      +RFIKS(INEPH,ISEG,2,ISOL,IX,1))
  180   CONTINUE
C
        DX=RTL(INEPH,ISEG)/FLOAT(RCHOP(INEPH,ISEG))
        DO 185 IX=1,CHOP
        SEGV(INEPH,ISEG)=SEGV(INEPH,ISEG)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1       (RFEVS(INEPH,ISEG,IX,1)+RFIVS(INEPH,ISEG,1,IX,1)
     1         +RFIVS(INEPH,ISEG,2,IX,1))+
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1       (RFEVS(INEPH,ISEG,IX+1,1)+RFIVS(INEPH,ISEG,1,IX+1,1)
     1         +RFIVS(INEPH,ISEG,2,IX+1,1))
        DO 184 ISOL=1,SOLS
  184   SEGK(INEPH,ISEG,ISOL)=SEGK(INEPH,ISEG,ISOL)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1  (RFEKS(INEPH,ISEG,ISOL,IX,1)+RFIKS(INEPH,ISEG,1,ISOL,IX,1)
     1     +RFIKS(INEPH,ISEG,2,ISOL,IX,1))+
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1  (RFEKS(INEPH,ISEG,ISOL,IX+1,1)+RFIKS(INEPH,ISEG,1,ISOL,IX+1,1)
     1     +RFIKS(INEPH,ISEG,2,ISOL,IX+1,1))
  185   CONTINUE
C
C  - ASCENDING: AHLm (ISEG=6)
C
        CHOP=OMCHOP
        ISEG=6
        DO 162 INEPH=1,6
        DO 160 IX=1,CHOP+1
        OMJVMS(CHOP+2-IX)=OMJVMS(CHOP+2-IX)+ RSM(INEPH,ISEG,IX,1)*
     1    (RFEVS(INEPH,ISEG,IX,1)+RFIVS(INEPH,ISEG,1,IX,1))
        DO 159 ISOL=1,SOLS
  159   OMJKMS(ISOL,CHOP+2-IX)=OMJKMS(ISOL,CHOP+2-IX)+ 
     1     RSM(INEPH,ISEG,IX,1)*
     1    (RFEKS(INEPH,ISEG,ISOL,IX,1)+RFIKS(INEPH,ISEG,1,ISOL,IX,1))
  160   CONTINUE
  162   CONTINUE
C
        DO 167 INEPH=1,6
        DX=RTL(INEPH,ISEG)/FLOAT(RCHOP(INEPH,ISEG))
        DO 165 IX=1,CHOP
        SEGV(INEPH,ISEG)=SEGV(INEPH,ISEG)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1       (RFEVS(INEPH,ISEG,IX,1)+RFIVS(INEPH,ISEG,1,IX,1))+
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1       (RFEVS(INEPH,ISEG,IX+1,1)+RFIVS(INEPH,ISEG,1,IX+1,1)) 
        DO 164 ISOL=1,SOLS
  164   SEGK(INEPH,ISEG,ISOL)=SEGK(INEPH,ISEG,ISOL)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1  (RFEKS(INEPH,ISEG,ISOL,IX,1)+RFIKS(INEPH,ISEG,1,ISOL,IX,1))+ 
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1  (RFEKS(INEPH,ISEG,ISOL,IX+1,1)+RFIKS(INEPH,ISEG,1,ISOL,IX+1,1))
  165   CONTINUE
  167   CONTINUE
C
C
C INNER MEDULLA
C
        ISEG=4
        INEPH=6
        CHOP=RCHOP(INEPH,ISEG)
        IMDIST(1) = OMDIST(OMCHOP+1)
	DO 210 KX=2,CHOP+1
  210   IMDIST(KX) = IMDIST(KX-1) + RTL(INEPH,ISEG)/FLOAT(CHOP)
        IMCHOP=CHOP
C
C - DESCENDING: lDHL (ISEG=4) and IMCD (ISEG=12)
C
        DO 232 INEPH=2,6
        CHOP=RCHOP(INEPH,ISEG)
        DO 230 IX=1,CHOP+1
        IMJVMS(IX)=IMJVMS(IX)+ RSM(INEPH,ISEG,IX,1)*
     1    (RFEVM(INEPH,ISEG,IX,1)+RFIVM(INEPH,ISEG,1,IX,1))
        DO 229 ISOL=1,SOLS
  229   IMJKMS(ISOL,IX)=IMJKMS(ISOL,IX)+ RSM(INEPH,ISEG,IX,1)*
     1    (RFEKM(INEPH,ISEG,ISOL,IX,1)+RFIKM(INEPH,ISEG,1,ISOL,IX,1))
  230   CONTINUE
  232   CONTINUE
C
        DO 237 INEPH=2,6
        DX=RTL(INEPH,ISEG)/FLOAT(RCHOP(INEPH,ISEG))
        CHOP=RCHOP(INEPH,ISEG)
        DO 235 IX=1,CHOP
        SEGV(INEPH,ISEG)=SEGV(INEPH,ISEG)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1       (RFEVM(INEPH,ISEG,IX,1)+RFIVM(INEPH,ISEG,1,IX,1))+
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1       (RFEVM(INEPH,ISEG,IX+1,1)+RFIVM(INEPH,ISEG,1,IX+1,1)) 
        DO 234 ISOL=1,SOLS
  234   SEGK(INEPH,ISEG,ISOL)=SEGK(INEPH,ISEG,ISOL)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1  (RFEKM(INEPH,ISEG,ISOL,IX,1)+RFIKM(INEPH,ISEG,1,ISOL,IX,1))+ 
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1  (RFEKM(INEPH,ISEG,ISOL,IX+1,1)+RFIKM(INEPH,ISEG,1,ISOL,IX+1,1))
  235   CONTINUE
  237   CONTINUE
C
        INEPH=1
        ISEG=12
        CHOP=RCHOP(INEPH,ISEG)
        DO 280 IX=1,CHOP+1
        IMJVMS(IX)=IMJVMS(IX)+ RSM(INEPH,ISEG,IX,1)*
     1    (RFEVS(INEPH,ISEG,IX,1)+RFIVS(INEPH,ISEG,1,IX,1))
        DO 279 ISOL=1,SOLS
  279   IMJKMS(ISOL,IX)=IMJKMS(ISOL,IX)+ RSM(INEPH,ISEG,IX,1)*
     1    (RFEKS(INEPH,ISEG,ISOL,IX,1)+RFIKS(INEPH,ISEG,1,ISOL,IX,1))
  280   CONTINUE
C
        DX=RTL(INEPH,ISEG)/FLOAT(RCHOP(INEPH,ISEG))
        CHOP=RCHOP(INEPH,ISEG)
        DO 285 IX=1,CHOP
        SEGV(INEPH,ISEG)=SEGV(INEPH,ISEG)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1       (RFEVS(INEPH,ISEG,IX,1)+RFIVS(INEPH,ISEG,1,IX,1))+
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1       (RFEVS(INEPH,ISEG,IX+1,1)+RFIVS(INEPH,ISEG,1,IX+1,1)) 
        DO 284 ISOL=1,SOLS
  284   SEGK(INEPH,ISEG,ISOL)=SEGK(INEPH,ISEG,ISOL)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1  (RFEKS(INEPH,ISEG,ISOL,IX,1)+RFIKS(INEPH,ISEG,1,ISOL,IX,1))+ 
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1  (RFEKS(INEPH,ISEG,ISOL,IX+1,1)+RFIKS(INEPH,ISEG,1,ISOL,IX+1,1))
  285   CONTINUE
C
C - ASCENDING (tAHL (ISEG=5))
C
        ISEG=5
        DO 262 INEPH=2,6
        CHOP=RCHOP(INEPH,ISEG)
        DO 260 IX=1,CHOP+1
        IMJVMS(CHOP+2-IX)=IMJVMS(CHOP+2-IX)+ RSM(INEPH,ISEG,IX,1)*
     1    (RFEVM(INEPH,ISEG,IX,1)+RFIVM(INEPH,ISEG,1,IX,1))
        DO 259 ISOL=1,SOLS
  259   IMJKMS(ISOL,CHOP+2-IX)=IMJKMS(ISOL,CHOP+2-IX)+
     1     RSM(INEPH,ISEG,IX,1)*
     1    (RFEKM(INEPH,ISEG,ISOL,IX,1)+RFIKM(INEPH,ISEG,1,ISOL,IX,1))
  260   CONTINUE
  262   CONTINUE
C
        DO 267 INEPH=2,6
        DX=RTL(INEPH,ISEG)/FLOAT(RCHOP(INEPH,ISEG))
        CHOP=RCHOP(INEPH,ISEG)
        DO 265 IX=1,CHOP
        SEGV(INEPH,ISEG)=SEGV(INEPH,ISEG)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1       (RFEVM(INEPH,ISEG,IX,1)+RFIVM(INEPH,ISEG,1,IX,1))+
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1       (RFEVM(INEPH,ISEG,IX+1,1)+RFIVM(INEPH,ISEG,1,IX+1,1)) 
        DO 264 ISOL=1,SOLS
  264   SEGK(INEPH,ISEG,ISOL)=SEGK(INEPH,ISEG,ISOL)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1  (RFEKM(INEPH,ISEG,ISOL,IX,1)+RFIKM(INEPH,ISEG,1,ISOL,IX,1))+ 
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1  (RFEKM(INEPH,ISEG,ISOL,IX+1,1)+RFIKM(INEPH,ISEG,1,ISOL,IX+1,1))
  265   CONTINUE
  267   CONTINUE
C
C
C MEDULLARY RAY
C
        ISEG=7
        INEPH=1
        CHOP=RCHOP(INEPH,ISEG)
        MRDIST(1) = 0.0
	DO 310 KX=2,CHOP+1
  310   MRDIST(KX) = MRDIST(KX-1) + RTL(INEPH,ISEG)/FLOAT(CHOP)
        MRCHOP=CHOP
C
C - DESCENDING: CCD (ISEG=10)
C
        ISEG=10
        INEPH=1
        CHOP=RCHOP(INEPH,ISEG)
        DO 320 IX=1,CHOP+1
        MRJVMS(IX)=MRJVMS(IX)+ RSM(INEPH,ISEG,IX,1)*
     1    (RFEVS(INEPH,ISEG,IX,1)+RFIVS(INEPH,ISEG,1,IX,1)
     1    +RFIVS(INEPH,ISEG,2,IX,1)+RFIVS(INEPH,ISEG,3,IX,1))
        DO 319 ISOL=1,SOLS
  319   MRJKMS(ISOL,IX)=MRJKMS(ISOL,IX)+ RSM(INEPH,ISEG,IX,1)*
     1    (RFEKS(INEPH,ISEG,ISOL,IX,1)+RFIKS(INEPH,ISEG,1,ISOL,IX,1)
     1    +RFIKS(INEPH,ISEG,2,ISOL,IX,1)+RFIKS(INEPH,ISEG,3,ISOL,IX,1))
  320   CONTINUE
C
        DX=RTL(INEPH,ISEG)/FLOAT(RCHOP(INEPH,ISEG))
        DO 325 IX=1,CHOP
        SEGV(INEPH,ISEG)=SEGV(INEPH,ISEG)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1       (RFEVS(INEPH,ISEG,IX,1)+RFIVS(INEPH,ISEG,1,IX,1)
     1       +RFIVS(INEPH,ISEG,2,IX,1)+RFIVS(INEPH,ISEG,3,IX,1))+
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1       (RFEVS(INEPH,ISEG,IX+1,1)+RFIVS(INEPH,ISEG,1,IX+1,1)
     1       +RFIVS(INEPH,ISEG,2,IX+1,1)+RFIVS(INEPH,ISEG,3,IX+1,1)) 
        DO 324 ISOL=1,SOLS
  324   SEGK(INEPH,ISEG,ISOL)=SEGK(INEPH,ISEG,ISOL)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1  (RFEKS(INEPH,ISEG,ISOL,IX,1)+RFIKS(INEPH,ISEG,1,ISOL,IX,1)
     1  +RFIKS(INEPH,ISEG,2,ISOL,IX,1)+RFIKS(INEPH,ISEG,3,ISOL,IX,1))+
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1  (RFEKS(INEPH,ISEG,ISOL,IX+1,1)+RFIKS(INEPH,ISEG,1,ISOL,IX+1,1)
     1  +RFIKS(INEPH,ISEG,2,ISOL,IX+1,1)
     1   +RFIKS(INEPH,ISEG,3,ISOL,IX+1,1))
  325   CONTINUE
C
C - ASCENDING: AHLc (ISEG=7)
C
        ISEG=7
        INEPH=1
        CHOP=RCHOP(INEPH,ISEG)
        DO 350 IX=1,CHOP+1
        MRJVMS(CHOP+2-IX)=MRJVMS(CHOP+2-IX)+
     1      RSM(INEPH,ISEG,IX,1)*
     1    (RFEVS(INEPH,ISEG,IX,1)+RFIVS(INEPH,ISEG,1,IX,1))
        DO 349 ISOL=1,SOLS
  349   MRJKMS(ISOL,CHOP+2-IX)=MRJKMS(ISOL,CHOP+2-IX)+
     1    RSM(INEPH,ISEG,IX,1)*
     1    (RFEKS(INEPH,ISEG,ISOL,IX,1)+RFIKS(INEPH,ISEG,1,ISOL,IX,1))
  350   CONTINUE
C
        DX=RTL(INEPH,ISEG)/FLOAT(RCHOP(INEPH,ISEG))
        DO 355 IX=1,CHOP
        SEGV(INEPH,ISEG)=SEGV(INEPH,ISEG)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1       (RFEVS(INEPH,ISEG,IX,1)+RFIVS(INEPH,ISEG,1,IX,1))+
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1       (RFEVS(INEPH,ISEG,IX+1,1)+RFIVS(INEPH,ISEG,1,IX+1,1)) 
        DO 344 ISOL=1,SOLS
  344   SEGK(INEPH,ISEG,ISOL)=SEGK(INEPH,ISEG,ISOL)+
     1    0.5*DX*RSM(INEPH,ISEG,IX,1)*
     1  (RFEKS(INEPH,ISEG,ISOL,IX,1)+RFIKS(INEPH,ISEG,1,ISOL,IX,1))+ 
     1    0.5*DX*RSM(INEPH,ISEG,IX+1,1)*
     1  (RFEKS(INEPH,ISEG,ISOL,IX+1,1)+RFIKS(INEPH,ISEG,1,ISOL,IX+1,1))
  355   CONTINUE
C
C
C FLUX PROFILES AND SUMMARY
C
        L2=RCHOP(1,2)
        DO 410 K=1,L2
        MEDJVMS(1)=MEDJVMS(1)+0.5*(OMJVMS(K)+OMJVMS(K+1))
        DO 409 J=1,SOLS
  409   MEDJKMS(J,1)=MEDJKMS(J,1)+0.5*(OMJKMS(J,K)+OMJKMS(J,K+1))
  410   CONTINUE
        DX=RTL(1,2)/FLOAT(RCHOP(1,2))
        MEDJVMS(1)=MEDJVMS(1)*DX
        DO 411 J=1,SOLS
  411   MEDJKMS(J,1)=MEDJKMS(J,1)*DX
C
        L1=1+RCHOP(1,2)
        L2=RCHOP(1,2)+RCHOP(1,3)
        DO 420 K=L1,L2
        MEDJVMS(2)=MEDJVMS(2)+0.5*(OMJVMS(K)+OMJVMS(K+1))
        DO 419 J=1,SOLS
  419   MEDJKMS(J,2)=MEDJKMS(J,2)+0.5*(OMJKMS(J,K)+OMJKMS(J,K+1))
  420   CONTINUE
        DX=RTL(1,3)/FLOAT(RCHOP(1,3))
        MEDJVMS(2)=MEDJVMS(2)*DX
        DO 421 J=1,SOLS
  421   MEDJKMS(J,2)=MEDJKMS(J,2)*DX
C
        L2=RCHOP(2,4)
        DO 430 K=1,L2
        MEDJVMS(3)=MEDJVMS(3)+0.5*(IMJVMS(K)+IMJVMS(K+1))
        DO 429 J=1,SOLS
  429   MEDJKMS(J,3)=MEDJKMS(J,3)+0.5*(IMJKMS(J,K)+IMJKMS(J,K+1))
  430   CONTINUE
        DX=RTL(2,4)/FLOAT(RCHOP(2,4))
        MEDJVMS(3)=MEDJVMS(3)*DX
        DO 431 J=1,SOLS
  431   MEDJKMS(J,3)=MEDJKMS(J,3)*DX
C
        L1=1+RCHOP(2,4)
        L2=RCHOP(3,4)
        DO 440 K=L1,L2
        MEDJVMS(4)=MEDJVMS(4)+0.5*(IMJVMS(K)+IMJVMS(K+1))
        DO 439 J=1,SOLS
  439   MEDJKMS(J,4)=MEDJKMS(J,4)+0.5*(IMJKMS(J,K)+IMJKMS(J,K+1))
  440   CONTINUE
        DX=(RTL(3,4)-RTL(2,4))/FLOAT(RCHOP(3,4)-RCHOP(2,4))
        MEDJVMS(4)=MEDJVMS(4)*DX
        DO 441 J=1,SOLS
  441   MEDJKMS(J,4)=MEDJKMS(J,4)*DX
C
        L1=1+RCHOP(3,4)
        L2=RCHOP(4,4)
        DO 450 K=L1,L2
        MEDJVMS(5)=MEDJVMS(5)+0.5*(IMJVMS(K)+IMJVMS(K+1))
        DO 449 J=1,SOLS
  449   MEDJKMS(J,5)=MEDJKMS(J,5)+0.5*(IMJKMS(J,K)+IMJKMS(J,K+1))
  450   CONTINUE
        DX=(RTL(4,4)-RTL(3,4))/FLOAT(RCHOP(4,4)-RCHOP(3,4))
        MEDJVMS(5)=MEDJVMS(5)*DX
        DO 451 J=1,SOLS
  451   MEDJKMS(J,5)=MEDJKMS(J,5)*DX
C
        L1=1+RCHOP(4,4)
        L2=RCHOP(5,4)
        DO 460 K=L1,L2
        MEDJVMS(6)=MEDJVMS(6)+0.5*(IMJVMS(K)+IMJVMS(K+1))
        DO 459 J=1,SOLS
  459   MEDJKMS(J,6)=MEDJKMS(J,6)+0.5*(IMJKMS(J,K)+IMJKMS(J,K+1))
  460   CONTINUE
        DX=(RTL(5,4)-RTL(4,4))/FLOAT(RCHOP(5,4)-RCHOP(4,4))
        MEDJVMS(6)=MEDJVMS(6)*DX
        DO 461 J=1,SOLS
  461   MEDJKMS(J,6)=MEDJKMS(J,6)*DX
C
        L1=1+RCHOP(5,4)
        L2=RCHOP(6,4)
        DO 470 K=L1,L2
        MEDJVMS(7)=MEDJVMS(7)+0.5*(IMJVMS(K)+IMJVMS(K+1))
        DO 469 J=1,SOLS
  469   MEDJKMS(J,7)=MEDJKMS(J,7)+0.5*(IMJKMS(J,K)+IMJKMS(J,K+1))
  470   CONTINUE
        DX=(RTL(6,4)-RTL(5,4))/FLOAT(RCHOP(6,4)-RCHOP(5,4))
        MEDJVMS(7)=MEDJVMS(7)*DX
        DO 471 J=1,SOLS
  471   MEDJKMS(J,7)=MEDJKMS(J,7)*DX
C
        L2=RCHOP(1,7)
        DO 480 K=1,L2
        MEDJVMS(8)=MEDJVMS(8)+0.5*(MRJVMS(K)+MRJVMS(K+1))
        DO 479 J=1,SOLS
  479   MEDJKMS(J,8)=MEDJKMS(J,8)+0.5*(MRJKMS(J,K)+MRJKMS(J,K+1))
  480   CONTINUE
        DX=RTL(1,7)/FLOAT(RCHOP(1,7))
        MEDJVMS(8)=MEDJVMS(8)*DX
        DO 481 J=1,SOLS
  481   MEDJKMS(J,8)=MEDJKMS(J,8)*DX
C
        IF (SWJ.EQ.0) GO TO 900
C
C BEFORE ANY SCALING, THE UNITS OF JVMS AND JKMS ARE ML/S/CM AND MMOL/S/CM
C
        SCAL=1.D3
        DO 510 K=1,OMCHOP
  510   WRITE (16,501) OMDIST(K),SCAL*OMJVMS(K),
     1    (SCAL*OMJKMS(J,K),J=1,4),(SCAL*OMJKMS(J,K),J=7,9),
     1    SCAL*OMJKMS(11,K)
        DO 512 K=1,IMCHOP+1
  512   WRITE (16,501) IMDIST(K),SCAL*IMJVMS(K),
     1    (SCAL*IMJKMS(J,K),J=1,4),(SCAL*IMJKMS(J,K),J=7,9),
     1    SCAL*IMJKMS(11,K)
        WRITE (16,502)
        DO 514 K=1,MRCHOP+1,2
  514   WRITE (16,501) MRDIST(K),SCAL*MRJVMS(K),
     1    (SCAL*MRJKMS(J,K),J=1,4),(SCAL*MRJKMS(J,K),J=7,9),
     1    SCAL*MRJKMS(11,K)
  501   FORMAT (8D16.8)
  502   FORMAT (//)
C
C BELOW HERE ARE SUMMATIONS BY SLICE AND VESSELS AND INTERNAL CHECKS ON THE DATA
C
	WRITE (19,522) (SOL(I),I=1,4),(SOL(I),I=7,9),SOL(11)
  522   FORMAT(//,4X,'SLICE',8X,'VOL',7X,10(A5,7X))
        DIST=0.D0
        WRITE (19,524) DIST,MEDJVMS(8),
     1   (MEDJKMS(J,8),J=1,4),(MEDJKMS(J,8),J=7,9),
     1   MEDJKMS(11,8)
        DO 520 K=1,7
        IF (K.EQ.1) THEN
        DIST=OMDIST(1+OMCHOP/2)
        ELSE IF (K.EQ.2) THEN
        DIST=OMDIST(1+OMCHOP)
        ELSE
        DIST=IMDIST(1+((K-2)*IMCHOP/5))
        ENDIF
  520   WRITE (19,524) DIST,MEDJVMS(K),
     1   (MEDJKMS(J,K),J=1,4),(MEDJKMS(J,K),J=7,9),
     1   MEDJKMS(11,K)
  524   FORMAT(12D12.4)
C
        WRITE (304,521)
  521   FORMAT(/,' NEPHRON FLUXES')
        WRITE (304,526) (FLOAT(K-1),K=1,8)
  526   FORMAT(2X,'SLICE',2X,8(F5.1,7X))
        WRITE (304,527) (MEDJVMS(K),K=1,8)
        DO 525 ISOL=1,11
  525   WRITE (304,528) SOL(ISOL),(MEDJKMS(ISOL,K),K=1,8)
  527   FORMAT (' VOL ',8D12.4)
  528   FORMAT (A5,8D12.4)
C
C TOTALS FOR OM
C
        DO 530 J=1,SOLS
        TJKMS(J)=0.D0
        DO 529 K=1,2
  529   TJKMS(J)=TJKMS(J)+MEDJKMS(J,K)
  530   CONTINUE
        TJVMS=0.D0
        DO 531 K=1,2
  531   TJVMS=TJVMS+MEDJVMS(K)
        WRITE (19,535) TJVMS,
     1   (TJKMS(J),J=1,4),(TJKMS(J),J=7,9),
     1   TJKMS(11)
  535   FORMAT(5X,'OM',5X,12D12.4)
C
C TOTALS FOR IM
C
        DO 540 J=1,SOLS
        TJKMS(J)=0.D0
        DO 539 K=3,7
  539   TJKMS(J)=TJKMS(J)+MEDJKMS(J,K)
  540   CONTINUE
        TJVMS=0.D0
        DO 541 K=3,7
  541   TJVMS=TJVMS+MEDJVMS(K)
        WRITE (19,545) TJVMS,
     1   (TJKMS(J),J=1,4),(TJKMS(J),J=7,9),
     1   TJKMS(11)
  545   FORMAT(5X,'IM',5X,12D12.4)
C
C TOTALS FOR ALL
C
        DO 550 J=1,SOLS
        TJKMS(J)=0.D0
        DO 549 K=1,7
  549   TJKMS(J)=TJKMS(J)+MEDJKMS(J,K)
  550   CONTINUE
        TJVMS=0.D0
        DO 551 K=1,7
  551   TJVMS=TJVMS+MEDJVMS(K)
        WRITE (19,555) TJVMS,
     1   (TJKMS(J),J=1,4),(TJKMS(J),J=7,9),
     1   TJKMS(11)
  555   FORMAT(4X,'TOT',5X,12D12.4)
C
C WHAT FOLLOWS IS DEBUGGING AND VERIFICATION CALCULATIONS
C
        GO TO 900
C
C CHECK SUMS BY SEG VALUES
C
        SLV(1)=SEGV(1,2)+SEGV(1,3)+SEGV(1,6)+
     1    SEGV(2,2)+SEGV(2,3)+SEGV(2,6)+
     1    SEGV(3,2)+SEGV(3,3)+SEGV(3,6)+
     1    SEGV(4,2)+SEGV(4,3)+SEGV(4,6)+
     1    SEGV(5,2)+SEGV(5,3)+SEGV(5,6)+
     1    SEGV(6,2)+SEGV(6,3)+SEGV(6,6)+SEGV(1,11)
        SLV(2)=SEGV(2,4)+SEGV(2,5)+
     1    SEGV(3,4)+SEGV(3,5)+
     1    SEGV(4,4)+SEGV(4,5)+
     1    SEGV(5,4)+SEGV(5,5)+
     1    SEGV(6,4)+SEGV(6,5)+SEGV(1,12)
        DO 740 J=1,SOLS
        SLK(1,J)=SEGK(1,2,J)+SEGK(1,3,J)+SEGK(1,6,J)+
     1    SEGK(2,2,J)+SEGK(2,3,J)+SEGK(2,6,J)+
     1    SEGK(3,2,J)+SEGK(3,3,J)+SEGK(3,6,J)+
     1    SEGK(4,2,J)+SEGK(4,3,J)+SEGK(4,6,J)+
     1    SEGK(5,2,J)+SEGK(5,3,J)+SEGK(5,6,J)+
     1    SEGK(6,2,J)+SEGK(6,3,J)+SEGK(6,6,J)+SEGK(1,11,J)
        SLK(2,J)=SEGK(2,4,J)+SEGK(2,5,J)+
     1    SEGK(3,4,J)+SEGK(3,5,J)+
     1    SEGK(4,4,J)+SEGK(4,5,J)+
     1    SEGK(5,4,J)+SEGK(5,5,J)+
     1    SEGK(6,4,J)+SEGK(6,5,J)+SEGK(1,12,J)
  740   CONTINUE
C
        WRITE (19,741)
  741   FORMAT (//)
        WRITE (19,535) SLV(1),
     1   (SLK(1,J),J=1,4),(SLK(1,J),J=7,9),
     1   SLK(1,11)
        WRITE (19,545) SLV(2),
     1   (SLK(2,J),J=1,4),(SLK(2,J),J=7,9),
     1   SLK(2,11)
        WRITE (19,555) SLV(1)+SLV(2),
     1   (SLK(1,J)+SLK(2,J),J=1,4),(SLK(1,J)+SLK(2,J),J=7,9),
     1   SLK(1,11)+SLK(2,11)
C
C
C CHECK THAT THE SEGMENTAL FLUX INTEGRALS (SEG*) EQUAL THE CHANGE IN FLOWS
C
        DO 720 INEPH=1,6
        DO 719 ISEG=2,3
        IEND=RCHOP(INEPH,ISEG)+1
C
        TV(INEPH)=RFVM(INEPH,ISEG,1,1)-RFVM(INEPH,ISEG,IEND,1)
        DO 705 J=1,SOLS
  705   TK(INEPH,J)=RFKM(INEPH,ISEG,J,1,1)-RFKM(INEPH,ISEG,J,IEND,1)
C
        WRITE (19,710) INEPH, ISEG
        WRITE (19,712) SEGV(INEPH,ISEG),
     1    (SEGK(INEPH,ISEG,J),J=1,4),(SEGK(INEPH,ISEG,J),J=7,9),
     1    SEGK(INEPH,ISEG,11)
        WRITE (19,714) TV(INEPH),
     1   (TK(INEPH,J),J=1,4), (TK(INEPH,J),J=7,9), 
     1   TK(INEPH,11)
  710   FORMAT (/,2I5)
  712   FORMAT (2X,'FLUX SUM',2X,12D12.4)
  714   FORMAT (1X,'FLOW DIFF',2X,12D12.4)
C
  719   CONTINUE
C
        ISEG=6
        IEND=RCHOP(INEPH,ISEG)+1
C
        TV(INEPH)=RFVM(INEPH,ISEG,1,1)-RFVM(INEPH,ISEG,IEND,1)
        DO 715 J=1,SOLS
  715   TK(INEPH,J)=RFKM(INEPH,ISEG,J,1,1)-RFKM(INEPH,ISEG,J,IEND,1)
C
        WRITE (19,710) INEPH, ISEG
        WRITE (19,712) SEGV(INEPH,ISEG),
     1    (SEGK(INEPH,ISEG,J),J=1,4),(SEGK(INEPH,ISEG,J),J=7,9),
     1    SEGK(INEPH,ISEG,11)
        WRITE (19,714) TV(INEPH),
     1   (TK(INEPH,J),J=1,4), (TK(INEPH,J),J=7,9), 
     1   TK(INEPH,11)

  720   CONTINUE
C
C
        DO 730 INEPH=2,6
        DO 729 ISEG=4,5
        IEND=RCHOP(INEPH,ISEG)+1
C
        TV(INEPH)=RFVM(INEPH,ISEG,1,1)-RFVM(INEPH,ISEG,IEND,1)
        DO 725 J=1,SOLS
  725   TK(INEPH,J)=RFKM(INEPH,ISEG,J,1,1)-RFKM(INEPH,ISEG,J,IEND,1)
C
        WRITE (19,710) INEPH, ISEG
        WRITE (19,712) SEGV(INEPH,ISEG),
     1    (SEGK(INEPH,ISEG,J),J=1,4),(SEGK(INEPH,ISEG,J),J=7,9),
     1    SEGK(INEPH,ISEG,11)
        WRITE (19,714) TV(INEPH),
     1   (TK(INEPH,J),J=1,4), (TK(INEPH,J),J=7,9), 
     1   TK(INEPH,11)
C
  729   CONTINUE
  730   CONTINUE
C
C
        INEPH=1
        ISEG=11
        IEND=RCHOP(INEPH,ISEG)+1
C
        TV(INEPH)=RFVM(INEPH,ISEG,1,1)-RFVM(INEPH,ISEG,IEND,1)
        DO 735 J=1,SOLS
  735   TK(INEPH,J)=RFKM(INEPH,ISEG,J,1,1)-RFKM(INEPH,ISEG,J,IEND,1)
C
        WRITE (19,710) INEPH, ISEG
        WRITE (19,712) SEGV(INEPH,ISEG),
     1    (SEGK(INEPH,ISEG,J),J=1,4),(SEGK(INEPH,ISEG,J),J=7,9),
     1    SEGK(INEPH,ISEG,11)
        WRITE (19,714) TV(INEPH),
     1   (TK(INEPH,J),J=1,4), (TK(INEPH,J),J=7,9), 
     1   TK(INEPH,11)
C
C
        INEPH=1
        ISEG=12
        IEND=RCHOP(INEPH,ISEG)+1
C
        TV(INEPH)=RFVM(INEPH,ISEG,1,1)-RFVM(INEPH,ISEG,IEND,1)
        DO 737 J=1,SOLS
  737   TK(INEPH,J)=RFKM(INEPH,ISEG,J,1,1)-RFKM(INEPH,ISEG,J,IEND,1)
C
        WRITE (19,710) INEPH, ISEG
        WRITE (19,712) SEGV(INEPH,ISEG),
     1    (SEGK(INEPH,ISEG,J),J=1,4),(SEGK(INEPH,ISEG,J),J=7,9),
     1    SEGK(INEPH,ISEG,11)
        WRITE (19,714) TV(INEPH),
     1   (TK(INEPH,J),J=1,4), (TK(INEPH,J),J=7,9), 
     1   TK(INEPH,11)
C
  900   CONTINUE
        SOLS=15
        RETURN
        END
