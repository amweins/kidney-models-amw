	PROGRAM APR
C  PROGRAM TO READ AN OUTPUT FILE FROM PROX.FOR
C  AND COMPUTE ABSOLUTE PROXIMAL REABSORPTIONS
C
C
	INTEGER NWR,IWR(2,14),JWR(2,14),CHOP
	REAL RES(243,16),TIME,WRRES(51,20)
        CHARACTER*12 IPTFIL,OPTFIL
        CHARACTER*4 SWI,SWT
C
	PRINT 2
    2   FORMAT(' TYPE THE INPUT FILENAME:',$)
	READ 4, IPTFIL
    4   FORMAT(A12)
	PRINT 6
    6   FORMAT(' TYPE THE OUTPUT FILENAME:',$)
	READ 4, OPTFIL
	PRINT 8
    8   FORMAT(' TYPE THE SPATIAL CHOP:',$)
	READ *, CHOP
	CHOP=CHOP+1
C
	OPEN(UNIT=1,FILE=IPTFIL)
	OPEN(UNIT=2,FILE=OPTFIL)
C
	NWR=13
	DO 7 J=1,13
	IWR(1,J)=1+2*CHOP
	JWR(1,J)=2+J
	IWR(2,J)=3*CHOP
    7   JWR(2,J)=2+J
C
C
	DO 810 KX=1,1000
C
  300   READ (1,310,END=420) TIME
  310   FORMAT (2(/),11X,F15.4)
	READ (1,325) ((RES(I,J),J=1,15),I=1,CHOP)
  325   FORMAT (///,(F7.4,F9.4,F9.2,4F9.6,D9.3,4F9.6,D9.3,2F9.6))
	READ (1,335) ((RES(I,J),J=1,15),I=1+CHOP,2*CHOP)
  335   FORMAT (///,(F7.4,14F9.4))
	READ (1,345) (RES(I,1),(RES(I,J),J=3,15),I=1+2*CHOP,3*CHOP)
  345   FORMAT (///,(F7.4,9X,5F9.6,D9.3,4F9.6,D9.3,2F9.6))
C
C
	WRRES(KX,1)=RES(IWR(1,1),JWR(1,1))
	WRRES(KX,2)=RES(IWR(2,1),JWR(2,1))
	DO 400 KY=3,NWR
  400   WRRES(KX,KY)=RES(IWR(1,KY-1),JWR(1,KY-1))-
     1  RES(IWR(2,KY-1),JWR(2,KY-1))
C
  810   CONTINUE
C
  420   DO 410 I=1,KX-1
  410   WRITE (2,415) (WRRES(I,J),J=1,NWR)
  415   FORMAT (8E16.8)
C
	STOP
	END
