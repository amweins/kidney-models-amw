	SUBROUTINE PCTRESD(CHOP)
C
	INTEGER SOLS,T,X,CHOP
C
C GENERAL PARAMETERS
	DOUBLE PRECISION
     1   Z(15),RT,RTE,F,
     1   EPSI,DT,RTAU,TIME,L0,L(81,2),
     1   PKC,PKF,PKN,PKP,KHY(5),KDHY(5)
C LUMINAL AND PERITUBULAR PARAMETERS
	DOUBLE PRECISION
     1   VM(81,2),PM(81,2),CM(15,81,2),
     1   IMPM(81,2),LCHM(81),XM(15,81),
     1   VS(81,2),PS(81,2),CS(15,81,2),
     1   IMPS(81,2),LCHS(81),XS(15,81),
     1   TL,DX,RM0,MUM,ETA,
     1   SM(81,2),AM(81,2),FVM(81,2),FKM(16,81,2)
C INTERSPACE PARAMETERS
	DOUBLE PRECISION
     1   AME,AE0,AE(81,2),MUA,CHVL0,CHVL(81,2),MUV,
     1   LPME,LPES,SME(15),SES(15),
     1   HME(15),HES(15),CME(15),CES(15),
     1   VE(81,2),PE(81,2),CE(15,81,2),LCHE(81),XE(15,81),
     1   FEVM(81,2),FEKM(15,81,2),FEVS(81,2),FEKS(15,81,2),CURE(81)
C CELL PARAMETERS
	DOUBLE PRECISION
     1   AIE(3),AMI(3),AIS(3),CLVL0(3),IMP0(3),CLVL(3,81,2),
     1   ZIMP(3),TBUF(3),PKB(3),CBUF(3,81,2),HCBUF(3,81,2),
     1   LPMI(3),LPIS(3),SMI(3,15),SIS(3,15),
     1   HMI(3,15),HIS(3,15),CMI(3,15),CIE(3,15),CIS(3,15),
     1   LMI(3,15,15),LIS(3,15,15),ATMI(3,15,81),ATIS(3,15,81),
     1   VI(3,81,2),PI(3,81,2),CI(3,15,81,2),IMP(3,81),LCHI(3,81),
     1   XI(3,15,81),FIVM(3,81,2),FIKM(3,15,81,2),FIVS(3,81,2),
     1   FIKS(3,15,81,2),CURI(3,81),JV(3,81,2),JK(3,15,81,2)
C SPECIAL TRANSPORTERS
	DOUBLE PRECISION
     1   NP(3),KNPN(3),KNPK(3),KNH4(3),NPHK(3),
     1   LHP(3),XIHP(3),XHP(3),NAE1(3),NTSC(3),NNHE3(3),
     1   JNAK(3,3,81,2),JHK(3,81,2),JHP(3,81,2),
     1   JAE1(3,81,2),JTSC(3,81,2),JNHE3(3,3,81,2),QIAMM
C TORQUE AND COMPLIANCE VARIABLES
	DOUBLE PRECISION
     1   TQM(81,2),RM(81,2),MUR,SCALMI,SCALIS,VM0,AM0,TQM0,
     1   LHP0(3),NP0(3),NNHE30(3),LPMI0(3),LPIS0(3),
     1   HMI0(3,15),HIS0(3,15),LMI0(3,15,15),LIS0(3,15,15),
     1   QIAMM0,MVL,MVD,RMT0
C
C
        COMMON SOLS,T,X,
     1   Z,RT,RTE,F,
     1   EPSI,DT,RTAU,TIME,DIST,
     1   PKC,PKF,PKN,PKP,KHY,KDHY,L0,L,
     1   VM,PM,CM,IMPM,LCHM,XM,
     1   VS,PS,CS,IMPS,LCHS,XS,
     1   TL,DX,RM0,MUM,ETA,
     1   SM,AM,FVM,FKM,
     1   AME,AE0,AE,MUA,CHVL0,CHVL,MUV,
     1   LPME,LPES,SME,SES,
     1   HME,HES,CME,CES,
     1   VE,PE,CE,LCHE,XE,
     1   FEVM,FEKM,FEVS,FEKS,CURE,
     1   AIE,AMI,AIS,CLVL0,IMP0,CLVL,
     1   ZIMP,TBUF,PKB,CBUF,HCBUF,
     1   LPMI,LPIS,SMI,SIS,
     1   HMI,HIS,CMI,CIE,CIS,
     1   LMI,LIS,ATMI,ATIS,
     1   VI,PI,CI,IMP,LCHI,XI,
     1   FIVM,FIKM,FIVS,FIKS,CURI,
     1   JV,JK
	COMMON/KINET/
     1   NP,KNPN,KNPK,KNH4,NPHK,
     1   LHP,XIHP,XHP,NAE1,NTSC,NNHE3,
     1   JNAK,JHK,JHP,JAE1,JTSC,JNHE3,QIAMM
	COMMON/TORQUE/
     1   TQM,RM,MUR,SCALMI,SCALIS,VM0,AM0,TQM0,
     1   LHP0,NP0,NNHE30,LPMI0,LPIS0,
     1   HMI0,HIS0,LMI0,LIS0,QIAMM0,MVL,MVD,RMT0
C
	DOUBLE PRECISION OSMM(81),OSMS(81),
     1    TA(81),QTA0,QTA1,ATA0,ATA1,TTIME
C
C
C  SOLUTE INDEX:
C	1-	NA+
C	2-	K+
C	3-	CL-
C	4-	HCO3-
C	5-	H2CO3
C	6-	CO2
C	7-	HPO4--
C	8-	H2PO4-
C	9-	UREA
C	10-	NH3
C	11-	NH4+
C	12-	H+
C	13-	HCO2-
C	14-	H2CO2
C	15-	GLUC
C
C
	CHARACTER*5 SOL(17)
	SOL(1)='  NA '
	SOL(2)='  K  '
	SOL(3)='  CL '
	SOL(4)=' HCO3'
	SOL(5)='H2CO3'
	SOL(6)=' CO2 '
	SOL(7)=' HPO4'
	SOL(8)='H2PO4'
	SOL(9)=' UREA'
	SOL(10)=' NH3 '
	SOL(11)=' NH4 '
	SOL(12)='  H  '
	SOL(13)=' HCO2'
	SOL(14)='H2CO2'
	SOL(15)=' GLUC'
	SOL(16)=' IMPM'
	SOL(17)='  TA '
	IS=SOLS+1
 	ATA0=10**(7.4 - 6.10142)
 	ATA1=10**(7.4 - 6.8)
C
	TTIME=0.D0
	DO 310 KX=X-CHOP,X-1
  310   TTIME=TTIME + 
     1    DX*0.5*(AM(KX,T)/FVM(KX,T) + AM(KX+1,T)/FVM(KX+1,T))
C
	DO 320 KX=X-CHOP,X
	OSMM(KX)=IMPM(KX,T)
 	QTA0=ATA0*CM(6,KX,T) - CM(4,KX,T)
 	QTA1=(ATA1*CM(8,KX,T) - CM(7,KX,T))/(ATA1 + 1.D0)
 	TA(KX)= QTA1
	DO 320 I=1,SOLS
  320 	OSMM(KX)=OSMM(KX)+CM(I,KX,T)
C
	WRITE (50,398) TTIME
  398   FORMAT (1H1,//,5X,'TTIME=',F15.4)
C
	WRITE (50,400) (SOL(I),I=1,11),(SOL(I),I=13,16)
  400   FORMAT(//,2X,'DIST',4X,'VM',7X,'PM',3X,'CM:',
     1  15(A5,4X))
	DIST=DIST-TL-DX
	DO 410 KX=X-CHOP,X
	DIST=DIST+DX
  410   WRITE (50,420) DIST,
     1  VM(KX,T),PM(KX,T),(CM(I,KX,T),I=1,11),
     1  (CM(I,KX,T),I=13,15),IMPM(KX,T)
  420   FORMAT (F7.4,F9.4,F9.2,4F9.6,D9.3,4F9.6,
     1   D9.3,2F9.6,D9.3,2F9.6)
C
	WRITE (50,430) (SOL(I),I=1,11),(SOL(I),I=13,15),SOL(12)
  430   FORMAT(//,2X,'DIST',4X,'TA',7X,'PHM',2X,
     1  'XM:',15(A5,4X))
	DIST=DIST-TL-DX
	DO 440 KX=X-CHOP,X
	DIST=DIST+DX
  440   WRITE (50,450) DIST,TA(KX),LCHM(KX),
     1    (XM(I,KX)-XS(I,KX),I=1,11),
     1    (XM(I,KX)-XS(I,KX),I=13,15),(XM(12,KX)-XS(12,KX))
  450   FORMAT (F7.4,17F9.4)
C
	WRITE (50,460) (SOL(I),I=1,11),(SOL(I),I=13,15),SOL(17)
  460   FORMAT(//,2X,'DIST',4X,'OSMM',4X,'FVM',3X,'FKM:',
     1  15(A5,4X))
	DIST=DIST-TL-DX
	DO 470 KX=X-CHOP,X
	DIST=DIST+DX
  470   WRITE (50,480) DIST,OSMM(KX),
     1  1.D6*FVM(KX,T),(1.D6*FKM(I,KX,T),I=1,11),
     1  (1.D6*FKM(I,KX,T),I=13,15),1.D6*FVM(KX,T)*TA(KX)
  480   FORMAT (F7.4,6F9.6,D9.3,4F9.6,
     1   D9.3,2F9.6,D9.3,2F9.6)
C
	DO 520 KX=X-CHOP,X
	OSMS(KX)=IMPS(KX,T)
	DO 520 I=1,SOLS
  520 	OSMS(KX)=OSMS(KX)+CS(I,KX,T)
C
	WRITE (51,598) TIME
  598   FORMAT (1H1,//,5X,'TIME=',F15.4)
C
	WRITE (51,600) (SOL(I),I=1,11),(SOL(I),I=13,16)
  600   FORMAT(//,2X,'DIST',4X,'VS',7X,'PS',3X,'CS:',
     1  15(A5,4X))
	DIST=DIST-TL-DX
	DO 610 KX=X-CHOP,X
	DIST=DIST+DX
  610   WRITE (51,620) DIST,
     1  VS(KX,T),PS(KX,T),(CS(I,KX,T),I=1,11),
     1  (CS(I,KX,T),I=13,15),IMPS(KX,T)
  620   FORMAT (F7.4,F9.4,F9.2,4F9.6,D9.3,4F9.6,
     1   D9.3,2F9.6,D9.3,2F9.6)
C
	WRITE (51,630) (SOL(I),I=1,SOLS)
  630   FORMAT(//,2X,'DIST',3X,'OSMS',6X,'PHS',2X,
     1  'XS:',15(A5,4X))
	DIST=DIST-TL-DX
	DO 640 KX=X-CHOP,X
	DIST=DIST+DX
  640   WRITE (51,650) DIST,OSMS(KX),LCHS(KX),(XS(I,KX),I=1,SOLS)
  650   FORMAT (F7.4,17F9.4)
C
	RETURN
	END
