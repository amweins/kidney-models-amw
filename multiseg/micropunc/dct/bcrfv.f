	PROGRAM BCRFV
C
C   PROGRAM USING BCR AS AN INNER LOOP TO CHECK PH EFFECTS OVER A RANGE OF FLOWS
C
	INTEGER SOLS,TLIM
C
	DOUBLE PRECISION
     1   VM(30),PM(30),CM(12,30),IMPM(30),
     1   VS(2,30),PS(2,30),CS(12,2,30),IMPS(2,30),
     1   DT(30),FVM(30),DFVM
C
	OPEN (22,FILE='dcbound.dat')
	OPEN (23,FILE='dcb.fv')
C
	SOLS=12
C
C  SOLUTE INDEX:
C	1-	NA+
C	2-	K+
C	3-	CL-
C	4-	HCO3-
C	5-	H2CO3
C	6-	CO2
C	7-	HPO4--
C	8-	H2PO4-
C	9-	UREA
C	10-	NH3
C	11-	NH4+
C	12-	H+
C
C
  700   PRINT 710
  710   FORMAT(' FLOW INCREMENT=',$)
	READ *, DFVM
C
C
C BOUNDARY VALUES,ACTIVE TRANSPORT,AND THE TIME INCREMENT ARE
C READ. THE TIME STEP WILL CYCLE FROM THIS POINT.
C
	DO 100 K=1,30
	READ(22,50,END=101) DT(K),FVM(K),
     1  VM(K),VS(1,K),VS(2,K),PM(K),PS(1,K),PS(2,K),
     1  IMPM(K),IMPS(1,K),IMPS(2,K),
     1  (CM(I,K),CS(I,1,K),CS(I,2,K),I=1,SOLS-1)
   50   FORMAT (2D12.4,/,3F8.4,/,3F8.4,/,3F8.4,/,(3F14.9))
  100   CONTINUE
  101   NSETS=K-1
C
C
	PRINT 60
   60   FORMAT(' TLIM=',$)
	READ *, TLIM
C
	DO 120 K=1,NSETS
	DO 900 L=1,TLIM
C
	WRITE (23,150) DT(K),FVM(K),
     1  VM(K),VS(1,K),VS(2,K),PM(K),PS(1,K),PS(2,K),
     1  IMPM(K),IMPS(1,K),IMPS(2,K),
     1  (CM(I,K),CS(I,1,K),CS(I,2,K),I=1,SOLS-1)
  150   FORMAT (2D12.4,/,3F8.4,/,3F8.4,/,3F8.4,/,(3F14.9))
	FVM(K)=FVM(K)+DFVM
C
  900   CONTINUE
  120   CONTINUE
C
	STOP
	END
