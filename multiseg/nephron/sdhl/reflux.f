	PROGRAM REFLUX
C READS FLUXES.DAT AND OUTPUTS THE REQUESTED SOLUTE IN GRAPHABLE FORMAT
C
	INTEGER CHOP,DCHOP,ISOL
	DOUBLE PRECISION MNA(405,9),MK(405,9),MCL(405,8),MNH4(405,12)
        CHARACTER*15 IPTFIL,OPTFIL,SOL,SWI
C
C
	PRINT 2
    2   FORMAT(' TYPE THE INPUT FILENAME:',$)
	READ 4, IPTFIL
    4   FORMAT(A15)
	OPEN(1,FILE=IPTFIL)
C
	PRINT 3
    3   FORMAT(' MESH SPACING - DATA FILE OR INTERACTIVE? (d/i):',$)
	READ *, SWI
	IF (SWI.EQ.'i') GO TO 7
	OPEN(4,FILE='dhlmesh.dat')
	READ (4,5) CHOP,DCHOP
    5   FORMAT(2I5)
	GO TO 12
C
    7   PRINT 8  
    8   FORMAT(' SPATIAL CHOP, AND PRINT SPACING:',$) 
	READ *, CHOP,DCHOP
   10   CONTINUE
   12   CHOP=CHOP+1
C
	DO 910 KX=1,5
C
	I1=(KX-1)*CHOP+1
	I2=(KX)*CHOP
C
	READ (1,320,END=440) ((MNA(I,J),J=1,4),I=I1,I2)
	READ (1,350) ((MK(I,J),J=1,4),I=I1,I2)
	READ (1,380) ((MCL(I,J),J=1,4),I=I1,I2)
	READ (1,410) ((MNH4(I,J),J=1,5),I=I1,I2)
  320   FORMAT (///,(F7.4,2X,3F10.4))
  350   FORMAT (///,(F7.4,2X,3F10.4))
  380   FORMAT (///,(F7.4,2X,3F10.4))
  410   FORMAT (///,(F7.4,2X,4F10.4))
C
  910   CONTINUE
  440   CONTINUE
C
C        OPEN(2,FILE='xyf.na')
C  510   DO 515 I=1,(KX-1)*CHOP,DCHOP
C  515   WRITE(2,388) (MNA(I,J),J=1,4)
C	CLOSE (2)
C
C	OPEN(2,FILE='xyf.k')
C  520   DO 525 I=1,(KX-1)*CHOP,DCHOP
C  525   WRITE(2,388) (MK(I,J),J=1,4)
C	CLOSE (2)
C	
C	OPEN(2,FILE='xyf.cl')
C  530   DO 535 I=1,(KX-1)*CHOP,DCHOP
C  535   WRITE(2,388) (MCL(I,J),J=1,4)
C	CLOSE (2)
C
C	OPEN(2,FILE='xyf.nh4')
C  540   DO 545 I=1,(KX-1)*CHOP,DCHOP
C  545   WRITE(2,388) (MNH4(I,J),J=1,5)
C	CLOSE (2)
C
	OPEN(2,FILE='xyf.cell')
  550   DO 555 I=1,(KX-1)*CHOP,DCHOP
  555   WRITE(2,388) MNA(I,1),
     1   MNA(I,2),MNA(I,3),MNA(I,4),
     1   MCL(I,2),MCL(I,3),MCL(I,4),
     1   MK(I,2),MK(I,3),MK(I,4),
     1   MNH4(I,2),MNH4(I,3),MNH4(I,4),MNH4(I,5)
	CLOSE (2)
C
  388   FORMAT(8E16.8)
C
	END
C
